!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(of){"use strict";try{(function(){of=of&&Object.prototype.hasOwnProperty.call(of,"default")?of.default:of;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function y(n,r){var i,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,m=(n(f,l=Error),f);function f(t,e){var n=l.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,f.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g;function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T=T||{},_=N||self;function S(){}function R(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function L(t){var e=R(t);return"array"==e||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),O=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:U).apply(null,arguments)}function C(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now||function(){return+new Date};function x(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0))t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++O);var t},j.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Y=_.navigator;if(Y){var J=Y.userAgent;if(J){H=J;break t}}H=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function K(t){var e={};for(var n in t)e[n]=t[n];return e}var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<$.length;o++)n=$[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=Q(H,"Opera"),ot=Q(H,"Trident")||Q(H,"MSIE"),st=Q(H,"Edge"),ut=st||ot,at=Q(H,"Gecko")&&!(Q(H.toLowerCase(),"webkit")&&!Q(H,"Edge"))&&!(Q(H,"Trident")||Q(H,"MSIE"))&&!Q(H,"Edge"),ht=Q(H.toLowerCase(),"webkit")&&!Q(H,"Edge");function ct(){var t=_.document;return t?t.documentMode:void 0}t:{var lt="",ft=(rt=H,at?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ht?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(ft&&(lt=ft?ft[1]:""),ot){var pt=ct();if(null!=pt&&pt>parseFloat(lt)){nt=String(pt);break t}}nt=lt}var dt,yt={};function vt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}if(_.document&&ot){var gt=ct();dt=gt||(parseInt(nt,10)||void 0)}else dt=void 0;var mt=dt,wt=!ot||9<=Number(mt),bt=ot&&!vt("9"),Et=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",S,e),_.removeEventListener("test",S,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function At(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},x(At,It);var Nt={2:"touch",3:"pen",4:"mouse"};At.prototype.b=function(){At.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++_t,this.V=this.X=!1}function Rt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function Lt(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=q(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Rt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}Lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new St(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),kt={};function Ut(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Gt(r);return e&&e[Tt]?e.sa(n,r,D(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ut(t,e[o],n,r,i);return null}return n=Gt(n),t&&t[Tt]?t.ra(e,n,D(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!wt)return null;var u,a,h=qt(t);if(h||(t[Ot]=h=new Lt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[Tt])Dt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=qt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):Rt(t)}}}function Mt(t){return t in kt?kt[t]:kt[t]="on"+t}function xt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Ct(t),n.call(r,e)}function jt(t,e){if(t.V)return!0;if(wt)return xt(t,new At(e,this));if(!e)t:{e=["window","event"];for(var n=_,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return xt(t,e=new At(e,this))}function qt(t){return(t=t[Ot])instanceof Lt?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gt(e){return"function"==R(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function Bt(){j.call(this),this.c=new Lt(this),(this.J=this).A=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var u=s.listener,a=s.aa||s.src;s.X&&Dt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}x(Bt,j),Bt.prototype[Tt]=!0,(A=Bt.prototype).addEventListener=function(t,e,n,r){Ut(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Gt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Pt(s=e.a[n],r,i,o))&&(Rt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&qt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new It(t,n);else if(t instanceof It)t.target=t.target||n;else{var i=t;tt(t=new It(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=zt(s,r,!0,t)&&i}if(i=zt(s=t.a=n,r,!0,t)&&i,i=zt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=zt(s=t.a=e[o],r,!1,t)&&i;return i},A.C=function(){if(Bt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Rt(n[r]);delete e.a[t],e.b--}}this.A=null},A.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=_.JSON.stringify;function Wt(){this.b=this.a=null}var Qt,Xt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Jt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function Zt(t){_.setTimeout(function(){throw t},0)}function Kt(t,e){var n;Qt||(n=_.Promise.resolve(void 0),Qt=function(){n.then(ee)}),$t||(Qt(),$t=!0),te.add(t,e)}Wt.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Wt;function ee(){for(var t;r=n=void 0,r=null,(n=te).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){Zt(t)}var e=Xt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}var n,r;$t=!1}function ne(t,e){Bt.call(this),this.b=t||1,this.a=e||_,this.f=V(this.Ua,this),this.g=M()}function re(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ie(t,e,n){if("function"==R(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function oe(t,e,n){j.call(this),this.f=null!=n?V(t,n):t,this.c=e,this.b=V(this.Pa,this),this.a=[]}function se(t){t.T=ie(t.b,t.c),t.f.apply(null,t.a)}function ue(t){j.call(this),this.b=t,this.a={}}x(ne,Bt),(A=ne.prototype).Z=!1,A.L=null,A.Ua=function(){if(this.Z){var t=M()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(re(this),this.start()))}},A.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=M())},A.C=function(){ne.M.C.call(this),re(this),delete this.a},x(oe,j),(A=oe.prototype).ba=!1,A.T=null,A.Ia=function(t){this.a=arguments,this.T?this.ba=!0:se(this)},A.C=function(){oe.M.C.call(this),this.T&&(_.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},A.Pa=function(){this.T=null,this.ba&&(this.ba=!1,se(this))},x(ue,j);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Ut(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function le(){}ue.prototype.C=function(){ue.M.C.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fe=null;function pe(){return fe=fe||new Bt}function de(t){It.call(this,"serverreachability",t)}function ye(t){var e=pe();e.dispatchEvent(new de(e))}function ve(t){It.call(this,"statevent",t)}function ge(t){var e=pe();e.dispatchEvent(new ve(e))}function me(t){It.call(this,"timingevent",t)}function we(t,e){if("function"!=R(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}x(de,It),x(ve,It),x(me,It);var be={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ee={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ie(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Ie.prototype.a=null;var Te,_e={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Se(){It.call(this,"d")}function Re(){It.call(this,"c")}function Le(){}function De(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ue(this),this.N=Pe,t=ut?125:void 0,this.O=new ne(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}x(Se,It),x(Re,It),x(Le,Ie),Te=new Le;var Pe=45e3,Oe={},ke={};function Ue(t,e,n){t.B=1,t.f=nn(Je(e)),t.j=n,t.F=!0,Ve(t,null)}function Ve(t,e){t.s=M(),xe(t),t.A=Je(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.w=0,t.a=ur(t.g,t.g.w?e:null),0<t.J&&(t.D=new oe(V(t.ya,t,t.a),t.J)),he(t.G,t.a,"readystatechange",t.Sa),e=t.m?K(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ye(1)}function Ce(t,e,n){for(var r=!0;!t.l&&t.w<n.length;){var i=Me(t,n);if(i==ke){4==e&&(t.c=4,ge(14),r=!1);break}if(i==Oe){t.c=4,ge(15),r=!1;break}Be(t,i)}4==e&&0==n.length&&(t.c=1,ge(16),r=!1),t.b=t.b&&r,r||(Ge(t),Fe(t))}function Me(t,e){var n=t.w,r=e.indexOf("\n",n);return-1==r?ke:(n=Number(e.substring(n,r)),isNaN(n)?Oe:(r+=1)+n>e.length?ke:(e=e.substr(r,n),t.w=r+n,e))}function xe(t){t.P=M()+t.N,je(t,t.N)}function je(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=we(V(t.Qa,t),e)}function qe(t){t.h&&(_.clearTimeout(t.h),t.h=null)}function Fe(t){0==t.g.u||t.l||nr(t.g,t)}function Ge(t){qe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,re(t.O),ce(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Be(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||An(n.b,t)))if(n.A=t.H,!t.o&&An(n.b,t)&&3==n.u){try{var r=n.ja.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;er(n),n.a.cancel(),n.a=null}tr(n),ge(18)}}else n.ia=i[1],0<n.ia-n.G&&i[2]<37500&&n.U&&0==n.m&&!n.l&&(n.l=we(V(n.Na,n),6e3));if(In(n.b)<=1&&n.O){try{n.O()}catch(t){}n.O=void 0}}else ir(n,11)}else if(!t.o&&n.a!=t||er(n),!z(e))for(e=r=n.ja.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.G=i[0],i=i[1],2==n.u)if("c"==i[0]){n.B=i[1],n.R=i[2];var o=i[3];null!=o&&(n.oa=o);var s=i[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var u=n,a=t.a;if(a){var h=a.a?a.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var c=u.b;!c.a&&(Q(h,"spdy")||Q(h,"quic")||Q(h,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(Nn(c,c.b),c.b=null))}if(u.s){var l=a.a?a.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(u.ha=l,en(u.v,u.s,l))}}n.u=3,n.c&&n.c.na();var f=t;if((u=n).ea=sr(u,u.w?u.R:null,u.P),f.o){Tn(u.b,f);var p=f,d=u.D;d&&p.setTimeout(d),p.h&&(qe(p),xe(p)),u.a=f}else $n(u);0<n.f.length&&Yn(n)}else"stop"!=i[0]&&"close"!=i[0]||ir(n,7);else 3==n.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?ir(n,7):Wn(n):"noop"!=i[0]&&n.c&&n.c.ma(i),n.m=0);ye(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)F(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=De.prototype).setTimeout=function(t){this.N=t},A.Sa=function(t){t=t.target;var e=this.D;e&&3==Gn(t)?e.Ia():this.ya(t)},A.ya=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.qa(),r=this.a.S();if(!(e<3||3==e&&!ut&&!this.a.Y())){this.l||4!=e||7==n||ye(8==n||r<=0?3:2),qe(this);var i=this.a.S();this.H=i;var o=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,ge(12),Ge(this),Fe(this);break t}this.o=!0,Be(this,a)}this.F?(Ce(this,e,o),ut&&this.b&&3==e&&(he(this.G,this.O,"tick",this.Ra),this.O.start())):Be(this,o),4==e&&Ge(this),this.b&&!this.l&&(4==e?nr(this.g,this):(this.b=!1,xe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,ge(12)):(this.c=0,ge(13)),Ge(this),Fe(this)}}}catch(t){}},A.Ra=function(){if(this.a){var t=Gn(this.a),e=this.a.Y();this.w<e.length&&(qe(this),Ce(this,t,e),this.b&&4!=t&&xe(this))}},A.cancel=function(){this.l=!0,Ge(this)},A.Qa=function(){this.h=null;var t=M();0<=t-this.P?(2!=this.B&&(ye(3),ge(17)),Ge(this),this.c=2,Fe(this)):je(this,this.P-t)},(A=He.prototype).I=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.K=function(){return We(this),this.a.concat()},A.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},A.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye){this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,Ke(this,t.c),$e(this,t.h),this.g=t.g,e=t.b;var n=new fn;n.c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i}else t&&(n=String(t).match(Xe))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=rn(n[2]||""),Ke(this,n[3]||"",!0),$e(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Je(t){return new Ye(t)}function Ze(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ke(t,e,n){t.c=n?rn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,cn)),t.b=new fn(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?hn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,ln)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,hn=/[#\?]/g,cn=/[#\?@]/g,ln=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function yn(t,e){return pn(t),e=gn(t,e),Qe(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),B(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ca&&_.ca.ua&&_.ca.ua()&&_.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){F(t,function(t){n.call(r,t,e,this)},this)},this)},A.K=function(){pn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.I=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.I(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function An(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Nn(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Sn(){}function Rn(){this.a=new Sn}function Ln(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;D(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Pn=_.JSON.parse;function On(t){Bt.call(this),this.headers=new He,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=kn,this.B=this.F=!1}x(On,Bt);var kn="",Un=/^https?$/i,Vn=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function Mn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,xn(t),qn(t)}function xn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&void 0!==T&&(!t.s[1]||4!=Gn(t)||2!=t.S()))if(t.l&&4==Gn(t))ie(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Gn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.D).match(Xe)[1]||null;if(!o&&_.self&&_.self.location){var s=_.self.location.protocol;o=s.substr(0,s.length-1)}i=!Un.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Gn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",xn(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=zn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=zn("baseRetryDelayMs",5e3,t),this.Ga=zn("retryDelaySeedMs",1e4,t),this.Da=zn("forwardChannelMaxRetries",2,t),this.ga=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new wn(t&&t.concurrentRequestLimit),this.ja=new Rn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Wn(t){if(Qn(t),3==t.u){var e=t.H++,n=Je(t.v);en(n,"SID",t.B),en(n,"RID",e),en(n,"TYPE","terminate"),Zn(t,n),(e=new De(t,e,void 0)).B=2,e.f=nn(Je(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=ur(e.g,null),e.a.$(e.f)),e.s=M(),xe(e)}or(t)}function Qn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(_.clearTimeout(t.i),t.i=null),er(t),t.b.cancel(),t.g&&("number"==typeof t.g&&_.clearTimeout(t.g),t.g=null)}function Xn(t,e){t.f.push(new mn(t.Fa++,e)),3==t.u&&Yn(t)}function Yn(t){En(t.b)||t.g||(t.g=!0,Kt(t.xa,t),t.o=0)}function Jn(t,e){var n;n=e?e.W:t.H++;var r=Je(t.v);en(r,"SID",t.B),en(r,"RID",n),en(r,"AID",t.G),Zn(t,r),t.h&&t.j&&Bn(r,t.h,t.j),n=new De(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),Nn(t.b,n),Ue(n,r,e)}function Zn(t,n){t.c&&ze({},function(t,e){en(n,e,t)})}function Kn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?V(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{Ln(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function $n(t){t.a||t.i||(t.J=1,Kt(t.wa,t),t.m=0)}function tr(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=we(V(t.wa,t),rr(t,t.m)),t.m++,1)}function er(t){null!=t.l&&(_.clearTimeout(t.l),t.l=null)}function nr(t,e){var n=null;if(t.a==e){er(t),t.a=null;var r=2}else{if(!An(t.b,e))return;n=e.i,Tn(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==r){n=e.j?e.j.length:0,e=M()-e.s;var i=t.o;(r=pe()).dispatchEvent(new me(r)),Yn(t)}else $n(t);else if(3==(i=e.c)||0==i&&0<t.A||!(1==r&&function(t,e){if(!(In(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=we(V(t.xa,t,e),rr(t,t.o)),t.o++,1}}(t,e)||2==r&&tr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function ir(t,e){if(2==e){var n=null;t.c&&(n=null);var r=V(t.Ta,t);n||(n=new Ye("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||Ze(n,"https"),nn(n)),function(t,e){var n=new le;if(_.Image){var r=new Image;r.onload=C(Dn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=C(Dn,n,r,"TestLoadImage: error",!1,e),r.onabort=C(Dn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=C(Dn,n,r,"TestLoadImage: timeout",!1,e),_.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else ge(2);t.u=0,t.c&&t.c.la(e),or(t),Qn(t)}function or(t){t.u=0,t.A=-1,t.c&&(0==_n(t.b).length&&0==t.f.length||(t.b.c.length=0,B(t.f),t.f.length=0),t.c.ka())}function sr(t,e,n){var r,i,o,s,u,a,h=(r=n)instanceof Ye?Je(r):new Ye(r,void 0);if(""!=h.c)e&&Ke(h,e+"."+h.c),$e(h,h.h);else{var c=_.location;i=c.protocol,o=e?e+"."+c.hostname:c.hostname,s=+c.port,u=n,a=new Ye(null,void 0),i&&Ze(a,i),o&&Ke(a,o),s&&$e(a,s),u&&(a.g=u),h=a}return t.N&&Z(t.N,function(t,e){en(h,e,t)}),e=t.s,n=t.ha,e&&n&&en(h,e,n),en(h,"VER",t.oa),Zn(t,h),h}function ur(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ea)).F=t.w,e}function ar(){}function hr(){if(ot&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function cr(t,e){Bt.call(this),this.a=new Hn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new pr(this)}function lr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Re.call(this),this.status=1}function pr(t){this.a=t}(A=On.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ae(this.G):Ae(Te),this.a.onreadystatechange=V(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Mn(this,t)}t=n||"";var i,o=new He(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=q(Vn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.B=(i=this.a,ot&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.ta,this)):this.m=ie(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Mn(this,t)}},A.ta=function(){void 0!==T&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),qn(this))},A.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),On.M.C.call(this)},A.va=function(){this.j||(this.w||this.l||this.g?jn(this):this.Oa())},A.Oa=function(){jn(this)},A.S=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},A.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},A.qa=function(){return this.h},A.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Hn.prototype).oa=8,A.u=1,A.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new De(this,t,void 0),r=this.j;if(this.F&&(r?tt(r=K(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Kn(this,n,e),en(i=Je(this.v),"RID",t),en(i,"CVER",22),this.s&&en(i,"X-HTTP-Session-Id",this.s),Zn(this,i),this.h&&r&&Bn(i,this.h,r),Nn(this.b,n),this.fa?(en(i,"$req",e),en(i,"SID","null"),n.R=!0,Ue(n,i,null)):Ue(n,i,e),this.u=2}}else 3==this.u&&(t?Jn(this,t):0==this.f.length||En(this.b)||Jn(this))},A.wa=function(){this.i=null,this.a=new De(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Je(this.ea);en(t,"RID","rpc"),en(t,"SID",this.B),en(t,"CI",this.U?"0":"1"),en(t,"AID",this.G),Zn(this,t),en(t,"TYPE","xmlhttp"),this.h&&this.j&&Bn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=nn(Je(t)),e.j=null,e.F=!0,Ve(e,n)},A.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,tr(this),ge(19))},A.Ta=function(t){ge(t?2:1)},(A=ar.prototype).na=function(){},A.ma=function(){},A.la=function(){},A.ka=function(){},A.Ha=function(){},hr.prototype.a=function(t,e){return new cr(t,e)},x(cr,Bt),(A=cr.prototype).addEventListener=function(t,e,n,r){cr.M.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){cr.M.removeEventListener.call(this,t,e,n,r)},A.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(0),t.P=e,t.N=n||{},t.U=t.W,t.v=sr(t,null,t.P),Yn(t)},A.close=function(){Wn(this.a)},A.La=function(t){if("string"==typeof t){var e={};e.__data__=t,Xn(this.a,e)}else this.g?((e={}).__data__=Ht(t),Xn(this.a,e)):Xn(this.a,t)},A.C=function(){this.a.c=null,delete this.f,Wn(this.a),delete this.a,cr.M.C.call(this)},x(lr,Se),x(fr,Re),x(pr,ar),pr.prototype.na=function(){this.a.dispatchEvent("a")},pr.prototype.ma=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.la=function(t){this.a.dispatchEvent(new fr)},pr.prototype.ka=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,cr.prototype.send=cr.prototype.La,cr.prototype.open=cr.prototype.Ka,cr.prototype.close=cr.prototype.close,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ne.EventType=_e).OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",Bt.prototype.listen=Bt.prototype.ra,On.prototype.listenOnce=On.prototype.sa,On.prototype.getLastError=On.prototype.Ma,On.prototype.getLastErrorCode=On.prototype.qa,On.prototype.getStatus=On.prototype.S,On.prototype.getResponseJson=On.prototype.Ja,On.prototype.getResponseText=On.prototype.Y,On.prototype.send=On.prototype.$;var dr={createWebChannelTransport:function(){return new hr},ErrorCode:be,EventType:Ee,WebChannel:Ne,XhrIo:On},yr=dr.createWebChannelTransport,vr=dr.ErrorCode,gr=dr.EventType,mr=dr.WebChannel,wr=dr.XhrIo,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir=of.SDK_VERSION,Ar=new h("@firebase/firestore");function Nr(){return Ar.logLevel}function Tr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ar.logLevel<=p.DEBUG){var r=e.map(Sr);Ar.debug.apply(Ar,v(["Firestore ("+Ir+"): "+t],r))}}function _r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ar.logLevel<=p.ERROR){var r=e.map(Sr);Ar.error.apply(Ar,v(["Firestore ("+Ir+"): "+t],r))}}function Sr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Rr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Ir+") INTERNAL ASSERTION FAILED: "+t;throw _r(e),new Error(e)}function Lr(t){t||Rr()}function Dr(t){return t}function Pr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Or=(kr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Pr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},kr);function kr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function Vr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Cr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Mr=(Object.defineProperty(xr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),xr.prototype.isEqual=function(t){return t instanceof xr&&t.projectId===this.projectId&&t.database===this.database},xr.prototype.o=function(t){return Ur(this.projectId,t.projectId)||Ur(this.database,t.database)},xr);function xr(t,e){this.projectId=t,this.database=e||"(default)"}function jr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Fr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Gr,Br,zr,Hr=(ai.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},ai.prototype.has=function(t){return void 0!==this.get(t)},ai.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},ai.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},ai.prototype.forEach=function(u){qr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},ai.prototype._=function(){return Fr(this.l)},ai),Wr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Qr=(n(ui,zr=Error),ui),Xr=(si.now=function(){return si.fromMillis(Date.now())},si.fromDate=function(t){return si.fromMillis(t.getTime())},si.fromMillis=function(t){var e=Math.floor(t/1e3);return new si(e,1e6*(t-1e3*e))},si.prototype.toDate=function(){return new Date(this.toMillis())},si.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},si.prototype.T=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},si.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},si.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},si.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},si),Yr=(oi.m=function(t){return new oi(t)},oi.min=function(){return new oi(new Xr(0,0))},oi.prototype.o=function(t){return this.timestamp.T(t.timestamp)},oi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},oi.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},oi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},oi.prototype.A=function(){return this.timestamp},oi),Jr=(Object.defineProperty(ii.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ii.prototype.isEqual=function(t){return 0===ii.P(this,t)},ii.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ii?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ii.prototype.limit=function(){return this.offset+this.length},ii.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ii.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},ii.prototype.v=function(){return this.segments[this.offset]},ii.prototype.S=function(){return this.get(this.length-1)},ii.prototype.get=function(t){return this.segments[this.offset+t]},ii.prototype._=function(){return 0===this.length},ii.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ii.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ii.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ii.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ii.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ii),Zr=(n(ri,Br=Jr),ri.prototype.V=function(t,e,n){return new ri(t,e,n)},ri.prototype.$=function(){return this.F().join("/")},ri.prototype.toString=function(){return this.$()},ri.N=function(t){if(0<=t.indexOf("//"))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ri(t.split("/").filter(function(t){return 0<t.length}))},ri.k=function(){return new ri([])},ri),Kr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$r=(n(ni,Gr=Jr),ni.prototype.V=function(t,e,n){return new ni(t,e,n)},ni.O=function(t){return Kr.test(t)},ni.prototype.$=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ni.O(t)||(t="`"+t+"`"),t}).join(".")},ni.prototype.toString=function(){return this.$()},ni.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},ni.M=function(){return new ni(["__name__"])},ni.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Qr(Wr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Qr(Wr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Qr(Wr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ni(e)},ni.k=function(){return new ni([])},ni),ti=(ei.B=function(t){return new ei(Zr.N(t).p(5))},ei.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ei.prototype.isEqual=function(t){return null!==t&&0===Zr.P(this.path,t.path)},ei.prototype.toString=function(){return this.path.toString()},ei.P=function(t,e){return Zr.P(t.path,e.path)},ei.W=function(t){return t.length%2==0},ei.j=function(t){return new ei(new Zr(t.slice()))},ei);function ei(t){this.path=t}function ni(){return null!==Gr&&Gr.apply(this,arguments)||this}function ri(){return null!==Br&&Br.apply(this,arguments)||this}function ii(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.R=n}function oi(t){this.timestamp=t}function si(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Qr(Wr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Qr(Wr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Qr(Wr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Qr(Wr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ui(t,e){var n=this;return(n=zr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function ai(t,e){this.h=t,this.u=e,this.l={}}function hi(t){return null==t}function ci(t){return-0===t&&1/t==-1/0}function li(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null}function fi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new li(t,e,n,r,i,o,s)}function pi(t){var e=Dr(t);if(null===e.G){var n=e.path.$();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return(e=t).field.$()+e.op.toString()+bo(e.value);var e}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return(e=t).field.$()+e.dir;var e}).join(","),hi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Du(e.startAt)),e.endAt&&(n+="|ub:",n+=Du(e.endAt)),e.G=n}return e.G}function di(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(r=t.orderBy[n],i=e.orderBy[n],r.dir!==i.dir||!r.field.isEqual(i.field))return!1;var r,i,o,s;if(t.filters.length!==e.filters.length)return!1;for(var u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],!(o instanceof fu&&s instanceof fu&&o.op===s.op&&o.field.isEqual(s.field)&&vo(o.value,s.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ou(t.startAt,e.startAt)&&Ou(t.endAt,e.endAt)}function yi(t){return ti.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var vi=(gi.fromBase64String=function(t){return new gi(atob(t))},gi.fromUint8Array=function(t){return new gi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},gi.prototype.toBase64=function(){return t=this.K,btoa(t);var t},gi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},gi.prototype.H=function(){return 2*this.K.length},gi.prototype.o=function(t){return Ur(this.K,t.K)},gi.prototype.isEqual=function(t){return this.K===t.K},gi);function gi(t){this.K=t}vi.Y=new vi("");function mi(t){this.count=t}var wi,bi,Ei=(Ii.prototype.Z=function(t){return new Ii(this.target,this.targetId,this.X,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ii.prototype.tt=function(t,e){return new Ii(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ii.prototype.et=function(t){return new Ii(this.target,this.targetId,this.X,this.sequenceNumber,this.J,t,this.resumeToken)},Ii);function Ii(t,e,n,r,i,o,s){void 0===i&&(i=Yr.min()),void 0===o&&(o=Yr.min()),void 0===s&&(s=vi.Y),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.J=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ai(t){switch(t){case Wr.OK:return Rr();case Wr.CANCELLED:case Wr.UNKNOWN:case Wr.DEADLINE_EXCEEDED:case Wr.RESOURCE_EXHAUSTED:case Wr.INTERNAL:case Wr.UNAVAILABLE:case Wr.UNAUTHENTICATED:return;case Wr.INVALID_ARGUMENT:case Wr.NOT_FOUND:case Wr.ALREADY_EXISTS:case Wr.PERMISSION_DENIED:case Wr.FAILED_PRECONDITION:case Wr.ABORTED:case Wr.OUT_OF_RANGE:case Wr.UNIMPLEMENTED:case Wr.DATA_LOSS:return 1;default:return Rr()}}function Ni(t){if(void 0===t)return _r("GRPC error has no .code"),Wr.UNKNOWN;switch(t){case wi.OK:return Wr.OK;case wi.CANCELLED:return Wr.CANCELLED;case wi.UNKNOWN:return Wr.UNKNOWN;case wi.DEADLINE_EXCEEDED:return Wr.DEADLINE_EXCEEDED;case wi.RESOURCE_EXHAUSTED:return Wr.RESOURCE_EXHAUSTED;case wi.INTERNAL:return Wr.INTERNAL;case wi.UNAVAILABLE:return Wr.UNAVAILABLE;case wi.UNAUTHENTICATED:return Wr.UNAUTHENTICATED;case wi.INVALID_ARGUMENT:return Wr.INVALID_ARGUMENT;case wi.NOT_FOUND:return Wr.NOT_FOUND;case wi.ALREADY_EXISTS:return Wr.ALREADY_EXISTS;case wi.PERMISSION_DENIED:return Wr.PERMISSION_DENIED;case wi.FAILED_PRECONDITION:return Wr.FAILED_PRECONDITION;case wi.ABORTED:return Wr.ABORTED;case wi.OUT_OF_RANGE:return Wr.OUT_OF_RANGE;case wi.UNIMPLEMENTED:return Wr.UNIMPLEMENTED;case wi.DATA_LOSS:return Wr.DATA_LOSS;default:return Rr()}}(bi=wi=wi||{})[bi.OK=0]="OK",bi[bi.CANCELLED=1]="CANCELLED",bi[bi.UNKNOWN=2]="UNKNOWN",bi[bi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bi[bi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bi[bi.NOT_FOUND=5]="NOT_FOUND",bi[bi.ALREADY_EXISTS=6]="ALREADY_EXISTS",bi[bi.PERMISSION_DENIED=7]="PERMISSION_DENIED",bi[bi.UNAUTHENTICATED=16]="UNAUTHENTICATED",bi[bi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bi[bi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bi[bi.ABORTED=10]="ABORTED",bi[bi.OUT_OF_RANGE=11]="OUT_OF_RANGE",bi[bi.UNIMPLEMENTED=12]="UNIMPLEMENTED",bi[bi.INTERNAL=13]="INTERNAL",bi[bi.UNAVAILABLE=14]="UNAVAILABLE",bi[bi.DATA_LOSS=15]="DATA_LOSS";var Ti=(Di.prototype.nt=function(t,e){return new Di(this.P,this.root.nt(t,e,this.P).copy(null,null,Si.st,null,null))},Di.prototype.remove=function(t){return new Di(this.P,this.root.remove(t,this.P).copy(null,null,Si.st,null,null))},Di.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Di.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Di.prototype._=function(){return this.root._()},Object.defineProperty(Di.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Di.prototype.it=function(){return this.root.it()},Di.prototype.rt=function(){return this.root.rt()},Di.prototype.ot=function(t){return this.root.ot(t)},Di.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Di.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Di.prototype.ht=function(t){return this.root.ht(t)},Di.prototype.at=function(){return new _i(this.root,null,this.P,!1)},Di.prototype.ut=function(t){return new _i(this.root,t,this.P,!1)},Di.prototype.ct=function(){return new _i(this.root,null,this.P,!0)},Di.prototype.lt=function(t){return new _i(this.root,t,this.P,!0)},Di),_i=(Li.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Li.prototype.wt=function(){return 0<this.ft.length},Li.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Li),Si=(Ri.prototype.copy=function(t,e,n,r,i){return new Ri(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ri.prototype._=function(){return!1},Ri.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Ri.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ri.prototype.min=function(){return this.left._()?this:this.left.min()},Ri.prototype.it=function(){return this.min().key},Ri.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Ri.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Ri.prototype.It=function(){if(this.left._())return Ri.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Ri.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Ri.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Ri.prototype.At=function(){return this.color},Ri.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.yt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.pt()),t},Ri.prototype.Rt=function(){var t=this.pt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).yt()).pt()),t},Ri.prototype.Vt=function(){var t=this.pt();return t.left.left.At()&&(t=(t=t.Pt()).pt()),t},Ri.prototype.yt=function(){var t=this.copy(null,null,Ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ri.prototype.Pt=function(){var t=this.copy(null,null,Ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ri.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ri.prototype.gt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Ri.prototype.vt=function(){if(this.At()&&this.left.At())throw Rr();if(this.right.At())throw Rr();var t=this.left.vt();if(t!==this.right.vt())throw Rr();return t+(this.At()?0:1)},Ri);function Ri(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ri.RED,this.left=null!=r?r:Ri.EMPTY,this.right=null!=i?i:Ri.EMPTY,this.size=this.left.size+1+this.right.size}function Li(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Di(t,e){this.P=t,this.root=e||Si.EMPTY}function Pi(){this.size=0}Si.EMPTY=null,Si.RED=!0,Si.st=!1,Si.EMPTY=(Object.defineProperty(Pi.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Pi.prototype.copy=function(t,e,n,r,i){return this},Pi.prototype.nt=function(t,e,n){return new Si(t,e)},Pi.prototype.remove=function(t,e){return this},Pi.prototype._=function(){return!0},Pi.prototype.ot=function(t){return!1},Pi.prototype.ht=function(t){return!1},Pi.prototype.it=function(){return null},Pi.prototype.rt=function(){return null},Pi.prototype.At=function(){return!1},Pi.prototype.gt=function(){return!0},Pi.prototype.vt=function(){return 0},new Pi);var Oi=(Ci.prototype.has=function(t){return null!==this.data.get(t)},Ci.prototype.first=function(){return this.data.it()},Ci.prototype.last=function(){return this.data.rt()},Object.defineProperty(Ci.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ci.prototype.indexOf=function(t){return this.data.indexOf(t)},Ci.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Ci.prototype.bt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Ci.prototype.St=function(t,e){var n;for(n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Ci.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Ci.prototype.at=function(){return new ki(this.data.at())},Ci.prototype.ut=function(t){return new ki(this.data.ut(t))},Ci.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Ci.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ci.prototype._=function(){return this.data._()},Ci.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ci.prototype.isEqual=function(t){if(!(t instanceof Ci))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Ci.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ci.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ci.prototype.copy=function(t){var e=new Ci(this.P);return e.data=t,e},Ci),ki=(Vi.prototype.dt=function(){return this.Ft.dt().key},Vi.prototype.wt=function(){return this.Ft.wt()},Vi),Ui=new Ti(ti.P);function Vi(t){this.Ft=t}function Ci(t){this.P=t,this.data=new Ti(this.P)}function Mi(){return Ui}function xi(){return Mi()}var ji=new Ti(ti.P);function qi(){return ji}var Fi=new Ti(ti.P),Gi=new Oi(ti.P);function Bi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gi,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var zi=new Oi(Ur);function Hi(){return zi}function Wi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Qi(t,e){this.targetId=t,this.ee=e}function Xi(t,e,n,r){void 0===n&&(n=vi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Yi=(ao.kt=function(t){return new ao(t.P)},ao.prototype.has=function(t){return null!=this.$t.get(t)},ao.prototype.get=function(t){return this.$t.get(t)},ao.prototype.first=function(){return this.Nt.it()},ao.prototype.last=function(){return this.Nt.rt()},ao.prototype._=function(){return this.Nt._()},ao.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.nt(t.key,t),e.Nt.nt(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Nt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.P=this.P,n.$t=t,n.Nt=e,n},ao),Ji=(uo.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Rr()},uo.prototype.Ot=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},uo),Zi=(so.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,Yi.kt(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.Mt._()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Mt.isEqual(t.Mt)&&su(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),Ki=(oo.Kt=function(t,e){var n=new Map;return n.set(t,$i.zt(t,e)),new oo(Yr.min(),n,Hi(),Mi(),Bi())},oo),$i=(io.zt=function(t,e){return new io(vi.Y,e,Bi(),Bi(),Bi())},io),to=(Object.defineProperty(ro.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),ro.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},ro.prototype.ce=function(){var n=Bi(),r=Bi(),i=Bi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Rr()}}),new $i(this.ie,this.re,n,r,i)},ro.prototype.le=function(){this.oe=!1,this.se=co()},ro.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},ro.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},ro.prototype.de=function(){this.ne+=1},ro.prototype.we=function(){--this.ne},ro.prototype.Te=function(){this.oe=!0,this.re=!0},ro),eo=(no.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof Ks?this.Ve(r,t.te):t.te instanceof $s&&this.ye(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ye(s,t.key,t.te)}},no.prototype.pe=function(n){var r=this;this.ge(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.be(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.be(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.be(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Rr()}})},no.prototype.ge=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.be(e)&&n(e)})},no.prototype.Ce=function(t){var e=t.targetId,n=t.ee.count,r=this.De(e);if(r){var i=r.target;if(yi(i))if(0===n){var o=new ti(i.path);this.ye(e,o,new $s(o,Yr.min()))}else Lr(1===n);else this.Fe(e)!==n&&(this.Se(e),this.Re=this.Re.add(e))}},no.prototype.$e=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n=o.De(e);if(n){if(t.Ht&&yi(n.target)){var r=new ti(n.target.path);null!==o.Ie.get(r)||o.Ne(e,r)||o.ye(e,r,new $s(r,i))}t.ae&&(s.set(e,t.ce()),t.le())}});var r=Bi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new Ki(i,s,this.Re,this.Ie,r);return this.Ie=Mi(),this.Ae=ho(),this.Re=new Oi(Ur),t},no.prototype.Ve=function(t,e){if(this.be(t)){var n=this.Ne(t,e.key)?2:0;this.ve(t)._e(e.key,n),this.Ie=this.Ie.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.ke(e.key).add(t))}},no.prototype.ye=function(t,e,n){if(this.be(t)){var r=this.ve(t);this.Ne(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.nt(e,n))}},no.prototype.removeTarget=function(t){this.me.delete(t)},no.prototype.Fe=function(t){var e=this.ve(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Jt.size},no.prototype.de=function(t){this.ve(t).de()},no.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new to,this.me.set(t,e)),e},no.prototype.ke=function(t){var e=this.Ae.get(t);return e||(e=new Oi(Ur),this.Ae=this.Ae.nt(t,e)),e},no.prototype.be=function(t){var e=null!==this.De(t);return e||Tr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.De=function(t){var e=this.me.get(t);return e&&e.he?null:this.Ee.Oe(t)},no.prototype.Se=function(e){var n=this;this.me.set(e,new to),this.Ee.xe(e).forEach(function(t){n.ye(e,t,null)})},no.prototype.Ne=function(t,e){return this.Ee.xe(t).has(e)},no);function no(t){this.Ee=t,this.me=new Map,this.Ie=Mi(),this.Ae=ho(),this.Re=new Oi(Ur)}function ro(){this.ne=0,this.se=co(),this.ie=vi.Y,this.re=!1,this.oe=!0}function io(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=r,this.Jt=i}function oo(t,e,n,r,i){this.J=t,this.Qt=e,this.Wt=n,this.jt=r,this.Gt=i}function so(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.Mt=i,this.fromCache=o,this.qt=s,this.Bt=u}function uo(){this.xt=new Ti(ti.P)}function ao(n){this.P=n?function(t,e){return n(t,e)||ti.P(t.key,e.key)}:function(t,e){return ti.P(t.key,e.key)},this.$t=qi(),this.Nt=new Ti(this.P)}function ho(){return new Ti(ti.P)}function co(){return new Ti(ti.P)}function lo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function fo(t){var e=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new Xr(e.seconds,e.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:Rr()}function vo(i,t){var e,n,r,o=yo(i);if(o!==yo(t))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return fo(i).isEqual(fo(t));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=Eo(i.timestampValue),n=Eo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return i.stringValue===t.stringValue;case 6:return r=t,Ao(i.bytesValue).isEqual(Ao(r.bytesValue));case 7:return i.referenceValue===t.referenceValue;case 8:return n=t,Io((e=i).geoPointValue.latitude)===Io(n.geoPointValue.latitude)&&Io(e.geoPointValue.longitude)===Io(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Io(t.integerValue)===Io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Io(t.doubleValue),r=Io(e.doubleValue);return n===r?ci(n)===ci(r):isNaN(n)&&isNaN(r)}return!1}(i,t);case 9:return Vr(i.arrayValue.values||[],t.arrayValue.values||[],vo);case 10:return function(t){var e=i.mapValue.fields||{},n=t.mapValue.fields||{};if(jr(e)!==jr(n))return!1;for(var r in e)if(e.hasOwnProperty(r)&&(void 0===n[r]||!vo(e[r],n[r])))return!1;return!0}(t);default:return Rr()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i,o,s,u,a,h,c,l,f=yo(t),p=yo(e);if(f!==p)return Ur(f,p);switch(f){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return h=e,c=Io(t.integerValue||t.doubleValue),l=Io(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(fo(t),fo(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Ao(o),a=Ao(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ur(Io(n.latitude),Io(r.latitude)))?i:Ur(Io(n.longitude),Io(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ur(r[s],o[s]);if(0!==u)return u;var a=mo(n[r[s]],i[o[s]]);if(0!==a)return a}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=Eo(t),r=Eo(e),i=Ur(n.seconds,r.seconds);return 0!==i?i:Ur(n.nanos,r.nanos)}function bo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Eo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Ao(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ti.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Rr();var t,e,n}(t)}function Eo(t){if(Lr(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e=0,n=po.exec(t);if(Lr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?vi.fromBase64String(t):vi.fromUint8Array(t)}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function To(t){return t&&"integerValue"in t}function _o(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function Ro(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Lo(t){return t&&"mapValue"in t}var Do={asc:"ASCENDING",desc:"DESCENDING"},Po={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Oo=function(t,e){this.s=t,this.Le=e};function ko(t){return{integerValue:""+t}}function Uo(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function Vo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?ko(e):Uo(t,e);var n}function Co(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function xo(t){return Lr(!!t),Yr.m((e=Eo(t),new Xr(e.seconds,e.nanos)));var e}function jo(t,e){return new Zr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).$()}function qo(t,e){return jo(t.s,e.path)}function Fo(t,e){var n,r,i,o=(r=e,Lr(Xo(i=Zr.N(r))),i);return Lr(o.get(1)===t.s.projectId),Lr(!o.get(3)&&!t.s.database||o.get(3)===t.s.database),new ti((Lr(4<(n=o).length&&"documents"===n.get(4)),n.p(5)))}function Go(t,e){return jo(t.s,e)}function Bo(t){return new Zr(["projects",t.s.projectId,"databases",t.s.database]).$()}function zo(t,e,n){return{name:qo(t,e),fields:n.proto.mapValue.fields}}function Ho(t,e){var n,r,i,o,s,u,a;if(e instanceof Ss)n={update:zo(t,e.key,e.value)};else if(e instanceof js)n={delete:qo(t,e.key)};else if(e instanceof Rs)n={update:zo(t,e.key,e.data),updateMask:(r=e.Me,i=[],r.fields.forEach(function(t){return i.push(t.$())}),{fieldPaths:i})};else if(e instanceof ks)n={transform:{document:qo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t){var e=t.transform;if(e instanceof $o)return{fieldPath:t.field.$(),setToServerValue:"REQUEST_TIME"};if(e instanceof ts)return{fieldPath:t.field.$(),appendMissingElements:{values:e.elements}};if(e instanceof os)return{fieldPath:t.field.$(),removeAllFromArray:{values:e.elements}};if(e instanceof hs)return{fieldPath:t.field.$(),increment:e.qe};throw Rr()}(t)})}};else{if(!(e instanceof qs))return Rr();n={verify:qo(t,e.key)}}return e.Ue.Be||(n.currentDocument=(o=t,void 0!==(s=e.Ue).updateTime?{updateTime:(u=o,a=s.updateTime,Co(u,a.A()))}:void 0!==s.exists?{exists:s.exists}:Rr())),n}function Wo(t){return{before:t.before,values:t.position}}function Qo(t){return{fieldPath:t.$()}}function Xo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Yo(){this.Qe=void 0}function Jo(t,e){return t instanceof hs?To(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Zo,Ko,$o=(n(ns,Ko=Yo),ns),ts=(n(es,Zo=Yo),es);function es(t){var e=this;return(e=Zo.call(this)||this).elements=t,e}function ns(){return null!==Ko&&Ko.apply(this,arguments)||this}function rs(t,e){for(var n=fs(e),r=function(e){n.some(function(t){return vo(t,e)})||n.push(e)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var is,os=(n(ss,is=Yo),ss);function ss(t){var e=this;return(e=is.call(this)||this).elements=t,e}function us(t,e){for(var n=fs(e),r=function(e){n=n.filter(function(t){return!vo(t,e)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var as,hs=(n(cs,as=Yo),cs);function cs(t,e){var n=this;return(n=as.call(this)||this).serializer=t,n.qe=e,n}function ls(t){return Io(t.integerValue||t.doubleValue)}function fs(t){return _o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ps(t,e){this.field=t,this.transform=e}var ds=(ys.prototype.We=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ys.prototype.isEqual=function(t){return Vr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ys);function ys(t){(this.fields=t).sort($r.P)}function vs(t,e){this.version=t,this.transformResults=e}var gs=(ms.je=function(){return new ms},ms.exists=function(t){return new ms(void 0,t)},ms.updateTime=function(t){return new ms(t)},Object.defineProperty(ms.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ms.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ms);function ms(t,e){this.updateTime=t,this.exists=e}function ws(t,e){return void 0!==t.updateTime?e instanceof Ks&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ks}function bs(){}function Es(t,e,n){return t instanceof Ss?(i=n,new Ks(t.key,i.version,t.value,{hasCommittedMutations:!0})):t instanceof Rs?function(t,e,n){if(!ws(t.Ue,e))return new tu(t.key,n.version);var r=Ps(t,e);return new Ks(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof ks?function(t,e,n){if(Lr(null!=n.transformResults),!ws(t.Ue,e))return new tu(t.key,n.version);var r=Vs(0,e),i=function(t,e,n){var r,i,o,s=[];Lr(t.length===n.length);for(var u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Ks&&(c=e.field(a.field)),s.push((r=h,i=c,o=n[u],r instanceof ts?rs(r,i):r instanceof os?us(r,i):o))}return s}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Cs(t,r.data(),i);return new Ks(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):(r=n,new $s(t.key,r.version,{hasCommittedMutations:!0}));var r,i}function Is(t,e,n,r){return t instanceof Ss?function(t,e){if(!ws(t.Ue,e))return e;var n=Ns(e);return new Ks(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Rs?function(t,e){if(!ws(t.Ue,e))return e;var n=Ns(e),r=Ps(t,e);return new Ks(t.key,n,r,{Ge:!0})}(t,e):t instanceof ks?function(t,e,n,r){if(!ws(t.Ue,e))return e;var i=Vs(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,h=null;n instanceof Ks&&(h=n.field(u.field)),null===h&&r instanceof Ks&&(h=r.field(u.field)),i.push((l=h,f=e,v=y=d=p=void 0,(c=a)instanceof $o?(v={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:f.seconds,nanos:f.nanoseconds}}}},l&&(v.fields.__previous_value__=l),{mapValue:v}):c instanceof ts?rs(c,l):c instanceof os?us(c,l):(d=Jo(p=c,l),y=ls(d)+ls(p.qe),To(d)&&To(p.qe)?ko(y):Uo(p.serializer,y))))}var c,l,f,p,d,y,v;return i}(t.fieldTransforms,n,e,r),s=Cs(t,i.data(),o);return new Ks(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,ws((i=t).Ue,o)?new $s(i.key,Yr.min()):o);var i,o}function As(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Me.isEqual(e.Me):2!==t.type||Vr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof ts&&o instanceof ts||i instanceof os&&o instanceof os?Vr(i.elements,o.elements,vo):i instanceof hs&&o instanceof hs?vo(i.qe,o.qe):i instanceof $o&&o instanceof $o);var n,r,i,o}))}function Ns(t){return t instanceof Ks?t.version:Yr.min()}var Ts,_s,Ss=(n(Ds,_s=bs),Ds),Rs=(n(Ls,Ts=bs),Ls);function Ls(t,e,n,r){var i=this;return(i=Ts.call(this)||this).key=t,i.data=e,i.Me=n,i.Ue=r,i.type=1,i}function Ds(t,e,n){var r=this;return(r=_s.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Ps(t,e){return n=t,r=e instanceof Ks?e.data():Fs.empty(),i=new Gs(r),n.Me.fields.forEach(function(t){if(!t._()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.Ke();var n,r,i}var Os,ks=(n(Us,Os=bs),Us);function Us(t,e){var n=this;return(n=Os.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=gs.exists(!0),n}function Vs(t,e){return e}function Cs(t,e,n){for(var r=new Gs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ke()}var Ms,xs,js=(n(Ws,xs=bs),Ws),qs=(n(Hs,Ms=bs),Hs),Fs=(zs.empty=function(){return new zs({mapValue:{}})},zs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Lo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},zs.prototype.isEqual=function(t){return vo(this.proto,t.proto)},zs),Gs=(Bs.prototype.set=function(t,e){return this.Ye(t,e),this},Bs.prototype.delete=function(t){return this.Ye(t,null),this},Bs.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.S(),e)},Bs.prototype.Ke=function(){var t=this.Xe($r.k(),this.He);return null!=t?new Fs(t):this.ze},Bs.prototype.Xe=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=Lo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=i.Xe(r.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Bs);function Bs(t){void 0===t&&(t=Fs.empty()),this.ze=t,this.He=new Map}function zs(t){this.proto=t}function Hs(t,e){var n=this;return(n=Ms.call(this)||this).key=t,n.Ue=e,n.type=4,n}function Ws(t,e){var n=this;return(n=xs.call(this)||this).key=t,n.Ue=e,n.type=3,n}function Qs(t){var u=[];return qr(t.fields||{},function(t,e){var n=new $r([t]);if(Lo(e)){var r=Qs(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new ds(u)}function Xs(t,e){this.key=t,this.version=e}var Ys,Js,Zs,Ks=(n(ou,Zs=Xs),ou.prototype.field=function(t){return this.Je.field(t)},ou.prototype.data=function(){return this.Je},ou.prototype.Ze=function(){return this.Je.proto},ou.prototype.isEqual=function(t){return t instanceof ou&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Je.isEqual(t.Je)},ou.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Je.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ou.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ou),$s=(n(iu,Js=Xs),iu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(iu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),iu.prototype.isEqual=function(t){return t instanceof iu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},iu),tu=(n(ru,Ys=Xs),ru.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ru.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ru.prototype.isEqual=function(t){return t instanceof ru&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ru),eu=(nu.on=function(t){return new nu(t)},Object.defineProperty(nu.prototype,"orderBy",{get:function(){if(null===this.nn){this.nn=[];var t=this.hn(),e=this.an();if(null!==t&&null===e)t.L()||this.nn.push(new ku(t)),this.nn.push(new ku($r.M(),"asc"));else{for(var n=!1,r=0,i=this.tn;r<i.length;r++){var o=i[r];this.nn.push(o),o.field.L()&&(n=!0)}if(!n){var s=0<this.tn.length?this.tn[this.tn.length-1].dir:"asc";this.nn.push(new ku($r.M(),s))}}}return this.nn},enumerable:!1,configurable:!0}),nu.prototype.un=function(t){var e=this.filters.concat([t]);return new nu(this.path,this.collectionGroup,this.tn.slice(),e,this.limit,this.en,this.startAt,this.endAt)},nu.prototype.cn=function(t){var e=this.tn.concat([t]);return new nu(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},nu.prototype.ln=function(t){return new nu(this.path,this.collectionGroup,this.tn.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},nu.prototype._n=function(t){return new nu(this.path,this.collectionGroup,this.tn.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},nu.prototype.fn=function(t){return new nu(this.path,this.collectionGroup,this.tn.slice(),this.filters.slice(),this.limit,this.en,t,this.endAt)},nu.prototype.dn=function(t){return new nu(this.path,this.collectionGroup,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,t)},nu.prototype.wn=function(t){return new nu(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},nu.prototype.Tn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.L())},nu.prototype.En=function(){return!hi(this.limit)&&"F"===this.en},nu.prototype.mn=function(){return!hi(this.limit)&&"L"===this.en},nu.prototype.an=function(){return 0<this.tn.length?this.tn[0].field:null},nu.prototype.hn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof fu&&n.In())return n.field}return null},nu.prototype.An=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof fu&&0<=t.indexOf(r.op))return r.op}return null},nu.prototype.Rn=function(){return yi(this.Pn())},nu.prototype.Vn=function(){return null!==this.collectionGroup},nu.prototype.Pn=function(){if(!this.sn)if("F"===this.en)this.sn=fi(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new ku(r.field,i))}var o=this.endAt?new Nu(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Nu(this.startAt.position,!this.startAt.before):null;this.sn=fi(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.sn},nu.prototype.rn=function(t){},nu);function nu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt&&this.rn(this.startAt),this.endAt&&this.rn(this.endAt)}function ru(){return null!==Ys&&Ys.apply(this,arguments)||this}function iu(t,e,n){var r=this;return(r=Js.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ou(t,e,n,r){var i=this;return(i=Zs.call(this,t,e)||this).Je=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function su(t,e){return di(t.Pn(),e.Pn())&&t.en===e.en}function uu(t){return pi(t.Pn())+"|lt:"+t.en}function au(t){return"Query(target="+(e=t.Pn(),n=e.path.$(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.$()+" "+e.op+" "+bo(e.value);var e}).join(", ")+"]"),hi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.$()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Du(e.startAt)),e.endAt&&(n+=", endAt: "+Du(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function hu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.C(o):ti.W(r.path)?r.path.isEqual(o):r.path.D(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.L()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Pu(e.startAt,e.orderBy,n))&&(!e.endAt||!Pu(e.endAt,e.orderBy,n)));var e,n,r,o}function cu(u){return function(t,e){for(var n=!1,r=0,i=u.orderBy;r<i.length;r++){var o=i[r],s=Uu(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var lu,fu=(n(pu,lu=function(){}),pu.create=function(t,e,n){if(t.L())return"in"===e?new bu(t,n):new wu(t,e,n);if(So(n)){if("=="!==e)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new pu(t,e,n)}if(Ro(n)){if("=="!==e)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new pu(t,e,n)}return"array-contains"===e?new Eu(t,n):"in"===e?new Iu(t,n):"array-contains-any"===e?new Au(t,n):new pu(t,e,n)},pu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&yo(this.value)===yo(e)&&this.yn(mo(e,this.value))},pu.prototype.yn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Rr()}},pu.prototype.In=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},pu);function pu(t,e,n){var r=this;return(r=lu.call(this)||this).field=t,r.op=e,r.value=n,r}var du,yu,vu,gu,mu,wu=(n(Lu,mu=fu),Lu.prototype.matches=function(t){var e=ti.P(t.key,this.key);return this.yn(e)},Lu),bu=(n(Ru,gu=fu),Ru.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ru),Eu=(n(Su,vu=fu),Su.prototype.matches=function(t){var e=t.field(this.field);return _o(e)&&go(e.arrayValue,this.value)},Su),Iu=(n(_u,yu=fu),_u.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value.arrayValue,e)},_u),Au=(n(Tu,du=fu),Tu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!_o(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},Tu),Nu=function(t,e){this.position=t,this.before=e};function Tu(t,e){return du.call(this,t,"array-contains-any",e)||this}function _u(t,e){return yu.call(this,t,"in",e)||this}function Su(t,e){return vu.call(this,t,"array-contains",e)||this}function Ru(t,e){var n=this;return(n=gu.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ti.B(t.referenceValue)}),n}function Lu(t,e,n){var r=this;return(r=mu.call(this,t,e,n)||this).key=ti.B(n.referenceValue),r}function Du(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return bo(t)}).join(",")}function Pu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.L()?ti.P(ti.B(s.referenceValue),n.key):mo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ou(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var ku=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Uu(t,e,n){var r,i,o,s,u=t.field.L()?ti.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?mo(o,s):Rr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Rr()}}var Vu=(Wu.prototype.gn=function(t,e,n){for(var r=n.vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Es(o,e,r[i]))}return e},Wu.prototype.bn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Is(i,e,e,this.pn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Is(a,e,o,this.pn))}return e},Wu.prototype.Sn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.bn(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},Wu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Bi())},Wu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vr(this.mutations,t.mutations,function(t,e){return As(t,e)})&&Vr(this.baseMutations,t.baseMutations,function(t,e){return As(t,e)})},Wu),Cu=(Hu.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=Fi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new Hu(t,e,n,r)},Hu),Mu=(zu.prototype.catch=function(t){return this.next(void 0,t)},zu.prototype.next=function(r,i){var o=this;return this.kn&&Rr(),this.kn=!0,this.Nn?this.error?this.xn(i,this.error):this.On(r,this.result):new zu(function(e,n){o.Fn=function(t){o.On(r,t).next(e,n)},o.$n=function(t){o.xn(i,t).next(e,n)}})},zu.prototype.Ln=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},zu.prototype.Mn=function(t){try{var e=t();return e instanceof zu?e:zu.resolve(e)}catch(t){return zu.reject(t)}},zu.prototype.On=function(t,e){return t?this.Mn(function(){return t(e)}):zu.resolve(e)},zu.prototype.xn=function(t,e){return t?this.Mn(function(){return t(e)}):zu.reject(e)},zu.resolve=function(n){return new zu(function(t,e){t(n)})},zu.reject=function(n){return new zu(function(t,e){e(n)})},zu.qn=function(t){return new zu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},zu.Bn=function(t){for(var n=zu.resolve(!1),e=function(e){n=n.next(function(t){return t?zu.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},zu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qn(i)},zu),xu=(Bu.prototype.jn=function(e,n){var r=this;return this.Qn.Gn(e,n).next(function(t){return r.Kn(e,n,t)})},Bu.prototype.Kn=function(t,r,i){return this.Un.zn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].bn(r,t);return t})},Bu.prototype.Hn=function(t,e,i){var o=xi();return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].bn(t,e);o=o.nt(t,e)}),o},Bu.prototype.Yn=function(e,t){var n=this;return this.Un.getEntries(e,t).next(function(t){return n.Xn(e,t)})},Bu.prototype.Xn=function(r,i){var o=this;return this.Qn.Jn(r,i).next(function(t){var e=o.Hn(r,i,t),n=Mi();return e.forEach(function(t,e){e=e||new $s(t,Yr.min()),n=n.nt(t,e)}),n})},Bu.prototype.Zn=function(t,e,n){return e.Rn()?this.ts(t,e.path):e.Vn()?this.es(t,e,n):this.ns(t,e,n)},Bu.prototype.ts=function(t,e){return this.jn(t,new ti(e)).next(function(t){var e=qi();return t instanceof Ks&&(e=e.nt(t.key,t)),e})},Bu.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=qi();return this.Wn.ss(n,s).next(function(t){return Mu.forEach(t,function(t){var e=r.wn(t.child(s));return o.ns(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},Bu.prototype.ns=function(e,n,t){var c,l,r=this;return this.Un.Zn(e,n,t).next(function(t){return c=t,r.Qn.rs(e,n)}).next(function(t){return l=t,r.os(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=Is(s,a,a,r.pn);c=h instanceof Ks?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){hu(n,e)||(c=c.remove(t))}),c})},Bu.prototype.os=function(t,e,n){for(var r=Bi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Rs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Un.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ks&&(h=h.nt(t,e))}),h})},Bu),ju=(Gu.us=function(t,e){for(var n=Bi(),r=Bi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Gu(t,e.fromCache,n,r)},Gu),qu=(Fu.prototype.ls=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Fu.prototype.next=function(){var t=++this.previousValue;return this._s&&this._s(t),t},Fu);function Fu(t,e){var n=this;this.previousValue=t,e&&(e.cs=function(t){return n.ls(t)},this._s=function(t){return e.fs(t)})}function Gu(t,e,n,r){this.targetId=t,this.fromCache=e,this.hs=n,this.as=r}function Bu(t,e,n){this.Un=t,this.Qn=e,this.Wn=n}function zu(t){var e=this;this.Fn=null,this.$n=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.kn=!1,t(function(t){e.Nn=!0,e.result=t,e.Fn&&e.Fn(t)},function(t){e.Nn=!0,e.error=t,e.$n&&e.$n(t)})}function Hu(t,e,n,r){this.batch=t,this.Cn=e,this.vn=n,this.Dn=r}function Wu(t,e,n,r){this.batchId=t,this.pn=e,this.baseMutations=n,this.mutations=r}qu.ds=-1;function Qu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Xu=(ea.prototype.reset=function(){this.As=0},ea.prototype.Vs=function(){this.As=this.Is},ea.prototype.ys=function(t){var e=this;this.cancel();var n=Math.floor(this.As+this.ps()),r=Math.max(0,Date.now()-this.Ps),i=Math.max(0,n-r);0<i&&Tr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.As+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Rs=this.ws.gs(this.Ts,i,function(){return e.Ps=Date.now(),t()}),this.As*=this.ms,this.As<this.Es&&(this.As=this.Es),this.As>this.Is&&(this.As=this.Is)},ea.prototype.vs=function(){null!==this.Rs&&(this.Rs.bs(),this.Rs=null)},ea.prototype.cancel=function(){null!==this.Rs&&(this.Rs.cancel(),this.Rs=null)},ea.prototype.ps=function(){return(Math.random()-.5)*this.As},ea),Yu=(ta.prototype.Cs=function(t,e){return this.Ss.add(e),Mu.resolve()},ta.prototype.ss=function(t,e){return Mu.resolve(this.Ss.getEntries(e))},ta),Ju=($u.prototype.add=function(t){var e=t.S(),n=t.g(),r=this.index[e]||new Oi(Zr.P),i=!r.has(n);return this.index[e]=r.add(n),i},$u.prototype.has=function(t){var e=t.S(),n=t.g(),r=this.index[e];return r&&r.has(n)},$u.prototype.getEntries=function(t){return(this.index[t]||new Oi(Zr.P)).F()},$u),Zu=(Ku.prototype.next=function(){return this.Ds+=2,this.Ds},Ku.Fs=function(){return new Ku(0)},Ku.$s=function(){return new Ku(-1)},Ku);function Ku(t){this.Ds=t}function $u(){this.index={}}function ta(){this.Ss=new Ju}function ea(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ws=t,this.Ts=e,this.Es=n,this.ms=r,this.Is=i,this.As=0,this.Rs=null,this.Ps=Date.now(),this.reset()}function na(t){return"IndexedDbTransactionError"===t.name}function ra(){return"undefined"!=typeof window?window:null}var ia=(ua.Ls=function(t,e,n,r,i){var o=new ua(t,e,Date.now()+n,r,i);return o.start(n),o},ua.prototype.start=function(t){var e=this;this.Ms=setTimeout(function(){return e.qs()},t)},ua.prototype.bs=function(){return this.qs()},ua.prototype.cancel=function(t){null!==this.Ms&&(this.clearTimeout(),this.Os.reject(new Qr(Wr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ua.prototype.qs=function(){var e=this;this.Ns.Bs(function(){return null!==e.Ms?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},ua.prototype.clearTimeout=function(){null!==this.Ms&&(this.xs(this),clearTimeout(this.Ms),this.Ms=null)},ua),oa=(Object.defineProperty(sa.prototype,"Xs",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),sa.prototype.Bs=function(t){this.enqueue(t)},sa.prototype.Js=function(t){this.Zs(),this.ti(t)},sa.prototype.ei=function(t){return this.Zs(),this.ti(t)},sa.prototype.ni=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Zs(),this.Ws?[3,2]:(this.Ws=!0,(e=ra())&&e.removeEventListener("visibilitychange",this.Ys),[4,this.ei(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},sa.prototype.enqueue=function(t){return this.Zs(),this.Ws?new Promise(function(t){}):this.ti(t)},sa.prototype.si=function(t){var e=this;this.Qs.push(t),this.Bs(function(){return e.ii()})},sa.prototype.ii=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Qs[0]()];case 2:return t.sent(),this.Qs.shift(),this.Hs.reset(),[3,4];case 3:if(!na(e=t.sent()))throw e;return Tr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Qs.length&&this.Hs.ys(function(){return n.ii()}),t.label=5;case 5:return[2]}})})},sa.prototype.ti=function(t){var r=this,e=this.Us.then(function(){return r.Ks=!0,t().catch(function(t){throw r.Gs=t,r.Ks=!1,_r("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ks=!1,t})});return this.Us=e},sa.prototype.gs=function(t,e,n){var r=this;this.Zs(),-1<this.zs.indexOf(t)&&(e=0);var i=ia.Ls(this,t,e,n,function(t){return r.ri(t)});return this.js.push(i),i},sa.prototype.Zs=function(){this.Gs&&Rr()},sa.prototype.oi=function(){},sa.prototype.hi=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},sa.prototype.ai=function(t){for(var e=0,n=this.js;e<n.length;e++)if(n[e].Ts===t)return!0;return!1},sa.prototype.ui=function(r){var i=this;return this.hi().then(function(){i.js.sort(function(t,e){return t.ks-e.ks});for(var t=0,e=i.js;t<e.length;t++){var n=e[t];if(n.bs(),"all"!==r&&n.Ts===r)break}return i.hi()})},sa.prototype.ci=function(t){this.zs.push(t)},sa.prototype.ri=function(t){var e=this.js.indexOf(t);this.js.splice(e,1)},sa);function sa(){var t=this;this.Us=Promise.resolve(),this.Qs=[],this.Ws=!1,this.js=[],this.Gs=null,this.Ks=!1,this.zs=[],this.Hs=new Xu(this,"async_queue_retry"),this.Ys=function(){return t.Hs.vs()};var e=ra();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ys)}function ua(t,e,n,r,i){this.Ns=t,this.Ts=e,this.ks=n,this.op=r,this.xs=i,this.Os=new Qu,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function aa(t,e){if(_r("AsyncQueue",e+": "+t),na(t))return new Qr(Wr.UNAVAILABLE,e+": "+t);throw t}var ha=(ca.di=function(t){return new ca(t,ca.wi,ca.Ti)},ca);function ca(t,e,n){this.li=t,this._i=e,this.fi=n}ha.Ei=-1,ha.mi=1048576,ha.Ii=41943040,ha.wi=10,ha.Ti=1e3,ha.Ai=new ha(ha.Ii,ha.wi,ha.Ti),ha.Ri=new ha(ha.Ei,0,0);var la=(fa.prototype.start=function(){return Promise.resolve()},fa.prototype.Ni=function(i){return d(this,void 0,void 0,function(){var e,m,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Qn,m=this.Di,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Qn.ki(v).next(function(t){return g=t,e=r.persistence.gi(i),m=new xu(r.vi,e,r.persistence.Fi()),e.ki(v)}).next(function(t){for(var e=[],n=[],r=Bi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];r=r.add(h.key)}}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Yn(v,r).next(function(t){return{xi:t,Oi:e,Li:n}})})})];case 1:return n=t.sent(),[2,(this.Qn=e,this.Di=m,this.Pi.$i(this.Di),n)]}})})},fa.prototype.Mi=function(h){var c,l=this,f=Xr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Bi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.Di.Yn(a,t).next(function(t){c=t;for(var e=[],n=0,r=h;n<r.length;n++){var i=r[n],o=(u=i,s=c.get(i.key),u instanceof ks?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ks?t.field(i.field):void 0,s=Jo(i.transform,o||null);null!=s&&(e=null==e?(new Gs).set(i.field,s):e.set(i.field,s))}return e?e.Ke():null}(s):null);null!=o&&e.push(new Rs(i.key,o,Qs(o.proto.mapValue),gs.exists(!0)))}var u,s;return l.Qn.qi(a,f,e,h)})}).then(function(t){var e=t.Sn(c);return{batchId:t.batchId,Bi:e}})},fa.prototype.Ui=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.vi.Qi({Wi:!0});return i.ji(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Qn.Gi(t)}).next(function(){return i.Di.Yn(t,e)})})},fa.prototype.Ki=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Qn.zi(e,t).next(function(t){return Lr(null!==t),n=t.keys(),r.Qn.Hi(e,t)}).next(function(){return r.Qn.Gi(e)}).next(function(){return r.Di.Yn(e,n)})})},fa.prototype.Yi=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Qn.Yi(t)})},fa.prototype.Xi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Si.Xi(t)})},fa.prototype.Ji=function(a){var h=this,c=a.J,l=this.Vi;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.vi.Qi({Wi:!0});l=h.Vi;var s=[];a.Qt.forEach(function(t,e){var n=l.get(e);if(n){s.push(h.Si.Zi(o,t.Jt,e).next(function(){return h.Si.tr(o,t.Yt,e)}));var r=t.resumeToken;if(0<r.H()){var i=n.tt(r,c).Z(o.er);l=l.nt(e,i),fa.nr(n,i,t)&&s.push(h.Si.sr(o,i))}}});var u=Mi(),n=Bi();if(a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof $s&&e.version.isEqual(Yr.min())?(i.ir(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.rr(e,c),u=u.nt(t,e)):Tr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Gt.has(t)&&s.push(h.persistence.hr.or(o,t))})})),!c.isEqual(Yr.min())){var t=h.Si.Xi(o).next(function(t){return h.Si.ar(o,o.er,c)});s.push(t)}return Mu.qn(s).next(function(){return i.apply(o)}).next(function(){return h.Di.Xn(o,u)})}).then(function(t){return h.Vi=l,t})},fa.nr=function(t,e,n){return Lr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.J.I()-t.J.I()>=this.ur||0<n.Yt.size+n.Xt.size+n.Jt.size},fa.prototype.cr=function(c){return d(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Mu.forEach(c,function(e){return Mu.forEach(e.hs,function(t){return h.persistence.hr.lr(n,e.targetId,t)}).next(function(){return Mu.forEach(e.as,function(t){return h.persistence.hr._r(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!na(e=t.sent()))throw e;return Tr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.Vi.get(o),u=s.J,a=s.et(u),this.Vi=this.Vi.nt(o,a));return[2]}})})},fa.prototype.dr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Qn.wr(t,e)})},fa.prototype.Tr=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Di.jn(t,e)})},fa.prototype.Er=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Si.mr(e,r).next(function(t){return t?(n=t,Mu.resolve(n)):i.Si.Ir(e).next(function(t){return n=new Ei(r,t,0,e.er),i.Si.Ar(e,n).next(function(){return n})})})}).then(function(t){var e=i.Vi.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(i.Vi=i.Vi.nt(t.targetId,t),i.yi.set(r,t.targetId)),t})},fa.prototype.mr=function(t,e){var n=this.yi.get(e);return void 0!==n?Mu.resolve(this.Vi.get(n)):this.Si.mr(t,e)},fa.prototype.Rr=function(o,s){return d(this,void 0,void 0,function(){var e,n,r,i=this;return y(this,function(t){switch(t.label){case 0:e=this.Vi.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.hr.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!na(r=t.sent()))throw r;return Tr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.Vi=this.Vi.remove(o),this.yi.delete(e.target),[2]}})})},fa.prototype.Pr=function(t,n){var r=this,i=Yr.min(),o=Bi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.mr(e,t.Pn()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Si.Vr(e,t.targetId).next(function(t){o=t})}).next(function(){return r.Pi.Zn(e,t,n?i:Yr.min(),n?o:Bi())}).next(function(t){return{documents:t,yr:o}})})},fa.prototype.ji=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Mu.resolve();return n.forEach(function(r){u=u.next(function(){return o.zn(t,r)}).next(function(t){var e=t,n=i.Dn.get(r);Lr(null!==n),(!e||e.version.o(n)<0)&&(e=s.gn(r,e,i))&&o.rr(e,i.Cn)})}),u.next(function(){return e.Qn.Hi(t,s)})},fa.prototype.pr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.gr(t,n.Vi)})},fa);function fa(t,e,n){this.persistence=t,this.Pi=e,this.Vi=new Ti(Ur),this.yi=new Hr(function(t){return pi(t)},di),this.pi=Yr.min(),this.Qn=t.gi(n),this.vi=t.bi(),this.Si=t.Ci(),this.Di=new xu(this.vi,this.Qn,this.persistence.Fi()),this.Pi.$i(this.Di)}function pa(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Wr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Tr("LocalStore","Unexpectedly lost primary lease"),[2]})})}la.ur=3e8;var da=(ga.prototype._=function(){return this.vr._()},ga.prototype.lr=function(t,e){var n=new ya(t,e);this.vr=this.vr.add(n),this.Sr=this.Sr.add(n)},ga.prototype.Dr=function(t,e){var n=this;t.forEach(function(t){return n.lr(t,e)})},ga.prototype._r=function(t,e){this.Fr(new ya(t,e))},ga.prototype.$r=function(t,e){var n=this;t.forEach(function(t){return n._r(t,e)})},ga.prototype.Nr=function(t){var e=this,n=new ti(new Zr([])),r=new ya(n,t),i=new ya(n,t+1),o=[];return this.Sr.bt([r,i],function(t){e.Fr(t),o.push(t.key)}),o},ga.prototype.kr=function(){var e=this;this.vr.forEach(function(t){return e.Fr(t)})},ga.prototype.Fr=function(t){this.vr=this.vr.delete(t),this.Sr=this.Sr.delete(t)},ga.prototype.xr=function(t){var e=new ti(new Zr([])),n=new ya(e,t),r=new ya(e,t+1),i=Bi();return this.Sr.bt([n,r],function(t){i=i.add(t.key)}),i},ga.prototype.Or=function(t){var e=new ya(t,0),n=this.vr.Ct(e);return null!==n&&t.isEqual(n.key)},ga),ya=(va.br=function(t,e){return ti.P(t.key,e.key)||Ur(t.Lr,e.Lr)},va.Cr=function(t,e){return Ur(t.Lr,e.Lr)||ti.P(t.key,e.key)},va);function va(t,e){this.key=t,this.Lr=e}function ga(){this.vr=new Oi(ya.br),this.Sr=new Oi(ya.Cr)}function ma(t,e){if(0!==e.length)throw new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Ca(e.length,"argument")+".")}function wa(t,e,n){if(e.length!==n)throw new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires "+Ca(n,"argument")+", but was called with "+Ca(e.length,"argument")+".")}function ba(t,e,n){if(e.length<n)throw new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Ca(n,"argument")+", but was called with "+Ca(e.length,"argument")+".")}function Ea(t,e,n,r){if(e.length<n||e.length>r)throw new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Ca(e.length,"argument")+".")}function Ia(t,e,n,r){Ra(t,e,Va(n)+" argument",r)}function Aa(t,e,n,r){void 0!==r&&Ia(t,e,n,r)}function Na(t,e,n,r){Ra(t,e,n+" option",r)}function Ta(t,e,n,r){void 0!==r&&Na(t,e,n,r)}function _a(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Da(s))}var u=Da(n);throw new Qr(Wr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Sa(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid value "+Da(r)+" provided to function "+t+"() for its "+Va(n)+" argument. Acceptable values: "+e.join(", "));return r}function Ra(t,e,n,r){if(!("object"===e?La(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Da(r);throw new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function La(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Da(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Rr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Pa(t,e,n){if(void 0===n)throw new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Va(e)+" argument, but it was undefined.")}function Oa(n,t,r){qr(t,function(t,e){if(r.indexOf(t)<0)throw new Qr(Wr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ka(t,e,n,r){var i=Da(r);return new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Va(n)+" argument to be a "+e+", but it was: "+i)}function Ua(t,e,n){if(n<=0)throw new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Va(e)+" argument to be a positive number, but it was: "+n+".")}function Va(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Ca(t,e){return t+" "+e+(1===t?"":"s")}function Ma(){if("undefined"==typeof Uint8Array)throw new Qr(Wr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function xa(){if("undefined"==typeof atob)throw new Qr(Wr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ja,qa,Fa=(Ya.fromBase64String=function(t){wa("Blob.fromBase64String",arguments,1),Ia("Blob.fromBase64String","string",1,t),xa();try{return new Ya(vi.fromBase64String(t))}catch(t){throw new Qr(Wr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Ya.fromUint8Array=function(t){if(wa("Blob.fromUint8Array",arguments,1),Ma(),!(t instanceof Uint8Array))throw ka("Blob.fromUint8Array","Uint8Array",1,t);return new Ya(vi.fromUint8Array(t))},Ya.prototype.toBase64=function(){return wa("Blob.toBase64",arguments,0),xa(),this.Mr.toBase64()},Ya.prototype.toUint8Array=function(){return wa("Blob.toUint8Array",arguments,0),Ma(),this.Mr.toUint8Array()},Ya.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ya.prototype.isEqual=function(t){return this.Mr.isEqual(t.Mr)},Ya),Ga=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Qr(Wr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Ia("FieldPath","string",e,t[e]),0===t[e].length)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.qr=new $r(t)},Ba=(n(Xa,qa=Ga),Xa.documentId=function(){return new Xa($r.M().$())},Xa.prototype.isEqual=function(t){if(!(t instanceof Xa))throw ka("isEqual","FieldPath",1,t);return this.qr.isEqual(t.qr)},Xa),za=new RegExp("[~\\*/\\[\\]]"),Ha=function(){this.Br=this},Wa=(n(Qa,ja=Ha),Qa.prototype.Qr=function(t){if(2!==t.Wr)throw 1===t.Wr?t.jr(this.Ur+"() can only appear at the top level of your update data"):t.jr(this.Ur+"() cannot be used with set() unless you pass {merge:true}");return t.Me.push(t.path),null},Qa.prototype.isEqual=function(t){return t instanceof Qa},Qa);function Qa(t){var e=this;return(e=ja.call(this)||this).Ur=t,e}function Xa(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qa.call(this,t)||this}function Ya(t){xa(),this.Mr=t}function Ja(t,e,n){return new Th({Wr:3,Gr:e.settings.Gr,methodName:t.Ur,Kr:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Za,Ka,$a,th,eh,nh,rh=(n(vh,nh=Ha),vh.prototype.Qr=function(t){return new ps(t.path,new $o)},vh.prototype.isEqual=function(t){return t instanceof vh},vh),ih=(n(yh,eh=Ha),yh.prototype.Qr=function(t){var e=Ja(this,t,!0),n=this.zr.map(function(t){return kh(t,e)}),r=new ts(n);return new ps(t.path,r)},yh.prototype.isEqual=function(t){return this===t},yh),oh=(n(dh,th=Ha),dh.prototype.Qr=function(t){var e=Ja(this,t,!0),n=this.zr.map(function(t){return kh(t,e)}),r=new os(n);return new ps(t.path,r)},dh.prototype.isEqual=function(t){return this===t},dh),sh=(n(ph,$a=Ha),ph.prototype.Qr=function(t){var e=new hs(t.serializer,Vo(t.serializer,this.Hr));return new ps(t.path,e)},ph.prototype.isEqual=function(t){return this===t},ph),uh=(n(fh,Ka=Ha),fh.delete=function(){return ma("FieldValue.delete",arguments),new ah(new Wa("FieldValue.delete"))},fh.serverTimestamp=function(){return ma("FieldValue.serverTimestamp",arguments),new ah(new rh("FieldValue.serverTimestamp"))},fh.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ba("FieldValue.arrayUnion",arguments,1),new ah(new ih("FieldValue.arrayUnion",t))},fh.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ba("FieldValue.arrayRemove",arguments,1),new ah(new oh("FieldValue.arrayRemove",t))},fh.increment=function(t){return Ia("FieldValue.increment","number",1,t),wa("FieldValue.increment",arguments,1),new ah(new sh("FieldValue.increment",t))},fh),ah=(n(lh,Za=uh),lh.prototype.Qr=function(t){return this.Br.Qr(t)},lh.prototype.isEqual=function(t){return t instanceof lh&&this.Br.isEqual(t.Br)},lh),hh=(Object.defineProperty(ch.prototype,"latitude",{get:function(){return this.Yr},enumerable:!1,configurable:!0}),Object.defineProperty(ch.prototype,"longitude",{get:function(){return this.Xr},enumerable:!1,configurable:!0}),ch.prototype.isEqual=function(t){return this.Yr===t.Yr&&this.Xr===t.Xr},ch.prototype.T=function(t){return Ur(this.Yr,t.Yr)||Ur(this.Xr,t.Xr)},ch);function ch(t,e){if(wa("GeoPoint",arguments,2),Ia("GeoPoint","number",1,t),Ia("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Qr(Wr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Qr(Wr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Yr=t,this.Xr=e}function lh(t){var e=this;return(e=Za.call(this)||this).Br=t,e.Ur=t.Ur,e}function fh(){return Ka.call(this)||this}function ph(t,e){var n=this;return(n=$a.call(this)||this).Ur=t,n.Hr=e,n}function dh(t,e){var n=this;return(n=th.call(this)||this).Ur=t,n.zr=e,n}function yh(t,e){var n=this;return(n=eh.call(this)||this).Ur=t,n.zr=e,n}function vh(t){var e=this;return(e=nh.call(this)||this).Ur=t,e}function gh(t){return new Oo(t,!0)}var mh=/^__.*__$/,wh=function(t,e,n){this.Jr=t,this.Zr=e,this.to=n},bh=(Ah.prototype.eo=function(t,e){var n=[];return null!==this.Me?n.push(new Rs(t,this.data,this.Me,e)):n.push(new Ss(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ks(t,this.fieldTransforms)),n},Ah),Eh=(Ih.prototype.eo=function(t,e){var n=[new Rs(t,this.data,this.Me,e)];return 0<this.fieldTransforms.length&&n.push(new ks(t,this.fieldTransforms)),n},Ih);function Ih(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function Ah(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function Nh(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Rr()}}var Th=(Object.defineProperty(Rh.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Rh.prototype,"Wr",{get:function(){return this.settings.Wr},enumerable:!1,configurable:!0}),Rh.prototype.so=function(t){return new Rh(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Me)},Rh.prototype.io=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.so({path:n,Kr:!1});return r.ro(t),r},Rh.prototype.oo=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.so({path:n,Kr:!1});return r.no(),r},Rh.prototype.ho=function(t){return this.so({path:void 0,Kr:!0})},Rh.prototype.jr=function(t){return jh(t,this.settings.methodName,this.settings.ao||!1,this.path,this.settings.Gr)},Rh.prototype.contains=function(e){return void 0!==this.Me.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},Rh.prototype.no=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.ro(this.path.get(t))},Rh.prototype.ro=function(t){if(0===t.length)throw this.jr("Document fields must not be empty");if(Nh(this.Wr)&&mh.test(t))throw this.jr('Document fields cannot begin and end with "__"')},Rh),_h=(Sh.prototype.uo=function(t,e,n,r){return void 0===r&&(r=!1),new Th({Wr:t,methodName:e,Gr:n,path:$r.k(),Kr:!1,ao:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Sh);function Sh(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||gh(t)}function Rh(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.no(),this.fieldTransforms=i||[],this.Me=o||[]}function Lh(t,e,n,r,i,o){void 0===o&&(o={});var s=t.uo(o.merge||o.mergeFields?2:0,e,n,i);Ch("Data must be an object, but it was:",s,r);var u,a,h=Uh(r,s);if(o.merge)u=new ds(s.Me),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Ga)d=p.qr;else{if("string"!=typeof p)throw Rr();d=xh(e,p,n)}if(!s.contains(d))throw new Qr(Wr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");qh(c,d)||c.push(d)}u=new ds(c),a=s.fieldTransforms.filter(function(t){return u.We(t.field)})}else u=null,a=s.fieldTransforms;return new bh(new Fs(h),u,a)}function Dh(t,o,s,e){var u=t.uo(1,o,s);Ch("Data must be an object, but it was:",u,e);var a=[],h=new Gs;qr(e,function(t,e){var n=xh(o,t,s),r=u.oo(n);if(e instanceof Ha&&e.Br instanceof Wa)a.push(n);else{var i=kh(e,r);null!=i&&(a.push(n),h.set(n,i))}});var n=new ds(a);return new Eh(h.Ke(),n,u.fieldTransforms)}function Ph(t,e,n,r,i,o){var s=t.uo(1,e,n),u=[Mh(e,r,n)],a=[i];if(o.length%2!=0)throw new Qr(Wr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Mh(e,o[h])),a.push(o[h+1]);for(var c=[],l=new Gs,f=u.length-1;0<=f;--f)if(!qh(c,u[f])){var p=u[f],d=a[f],y=s.oo(p);if(d instanceof Ha&&d.Br instanceof Wa)c.push(p);else{var v=kh(d,y);null!=v&&(c.push(p),l.set(p,v))}}var g=new ds(c);return new Eh(l.Ke(),g,s.fieldTransforms)}function Oh(t,e,n,r){return void 0===r&&(r=!1),kh(n,t.uo(r?4:3,e))}function kh(s,t){if(Vh(s))return Ch("Unsupported field value:",t,s),Uh(s,t);if(s instanceof Ha)return function(t,e){if(!Nh(e.Wr))throw e.jr(t.Ur+"() can only be used with update() and set()");if(!e.path)throw e.jr(t.Ur+"() is not currently supported inside arrays");var n=t.Qr(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Me.push(t.path),s instanceof Array){if(t.settings.Kr&&4!==t.Wr)throw t.jr("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=kh(i[r],t.ho(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Xr.fromDate(t);return{timestampValue:Co(e.serializer,n)}}if(t instanceof Xr){var r=new Xr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Co(e.serializer,r)}}if(t instanceof hh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Fa)return{bytesValue:Mo(e.serializer,t)};if(t instanceof wh){var i=e.s,o=t.Jr;if(!o.isEqual(i))throw e.jr("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:jo(t.Jr||e.s,t.Zr.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.jr("Unsupported field value: "+Da(t))}(s,t)}function Uh(t,r){var i={};return Fr(t)?r.path&&0<r.path.length&&r.Me.push(r.path):qr(t,function(t,e){var n=kh(e,r.io(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Vh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Xr||t instanceof hh||t instanceof Fa||t instanceof wh||t instanceof Ha)}function Ch(t,e,n){if(!Vh(n)||!La(n)){var r=Da(n);throw"an object"===r?e.jr(t+" a custom object"):e.jr(t+" "+r)}}function Mh(t,e,n){if(e instanceof Ga)return e.qr;if("string"==typeof e)return xh(t,e);throw jh("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function xh(t,e,n){try{return function(e){if(0<=e.search(za))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Ba.bind.apply(Ba,v([void 0],e.split("."))))}catch(t){throw new Qr(Wr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).qr}catch(e){throw jh(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function jh(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Qr(Wr.INVALID_ARGUMENT,(u+=". ")+t+a)}function qh(t,e){return t.some(function(t){return t.isEqual(e)})}var Fh=(Gh.prototype.co=function(){return null!=this.uid},Gh.prototype.lo=function(){return this.co()?"uid:"+this.uid:"anonymous-user"},Gh.prototype.isEqual=function(t){return t.uid===this.uid},Gh);function Gh(t){this.uid=t}Fh.UNAUTHENTICATED=new Fh(null),Fh._o=new Fh("google-credentials-uid"),Fh.fo=new Fh("first-party-uid");function Bh(t,e){this.user=e,this.type="OAuth",this.do={},this.do.Authorization="Bearer "+t}function zh(t){this.key=t}function Hh(t){this.key=t}function Wh(t,e,n){this.query=t,this.targetId=e,this.view=n}function Qh(t){this.key=t,this.eu=!1}function Xh(){this.$u=void 0,this.listeners=[]}var Yh,Jh,Zh,Kh,$h=(qc.prototype.getToken=function(){return Promise.resolve(null)},qc.prototype.To=function(){},qc.prototype.Eo=function(t){(this.wo=t)(Fh.UNAUTHENTICATED)},qc.prototype.mo=function(){this.wo=null},qc),tc=(jc.prototype.getToken=function(){var e=this,n=this.Ro,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Ro!==n?(Tr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new Bh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},jc.prototype.To=function(){this.forceRefresh=!0},jc.prototype.Eo=function(t){this.wo=t,this.Ao&&t(this.currentUser)},jc.prototype.mo=function(){this.auth&&this.auth.removeAuthTokenListener(this.Io),this.Io=null,this.wo=null},jc.prototype.Po=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new Fh(t)},jc),ec=(Object.defineProperty(xc.prototype,"do",{get:function(){var t={"X-Goog-AuthUser":this.yo},e=this.Vo.auth.po([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),xc),nc=(Mc.prototype.getToken=function(){return Promise.resolve(new ec(this.Vo,this.yo))},Mc.prototype.Eo=function(t){t(Fh.fo)},Mc.prototype.mo=function(){},Mc.prototype.To=function(){},Mc),rc=(Cc.prototype.Fo=function(){return 1===this.state||2===this.state||4===this.state},Cc.prototype.$o=function(){return 2===this.state},Cc.prototype.start=function(){3!==this.state?this.auth():this.No()},Cc.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Fo()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Cc.prototype.ko=function(){this.state=0,this.Hs.reset()},Cc.prototype.xo=function(){var t=this;this.$o()&&null===this.Do&&(this.Do=this.ws.gs(this.vo,6e4,function(){return t.Oo()}))},Cc.prototype.Lo=function(t){this.Mo(),this.stream.send(t)},Cc.prototype.Oo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.$o()?[2,this.close(0)]:[2]})})},Cc.prototype.Mo=function(){this.Do&&(this.Do.cancel(),this.Do=null)},Cc.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Mo(),this.Hs.cancel(),this.Co++,3!==e?this.Hs.reset():n&&n.code===Wr.RESOURCE_EXHAUSTED?(_r(n.toString()),_r("Using maximum backoff delay to prevent overloading the backend."),this.Hs.Vs()):n&&n.code===Wr.UNAUTHENTICATED&&this.So.To(),null!==this.stream&&(this.qo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Bo(n)];case 1:return t.sent(),[2]}})})},Cc.prototype.qo=function(){},Cc.prototype.auth=function(){var n=this;this.state=1;var t=this.Uo(this.Co),e=this.Co;this.So.getToken().then(function(t){n.Co===e&&n.Qo(t)},function(e){t(function(){var t=new Qr(Wr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Wo(t)})})},Cc.prototype.Qo=function(t){var e=this,n=this.Uo(this.Co);this.stream=this.jo(t),this.stream.Go(function(){n(function(){return e.state=2,e.listener.Go()})}),this.stream.Bo(function(t){n(function(){return e.Wo(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Cc.prototype.No=function(){var t=this;this.state=4,this.Hs.ys(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Cc.prototype.Wo=function(t){return Tr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Cc.prototype.Uo=function(e){var n=this;return function(t){n.ws.Bs(function(){return n.Co===e?t():(Tr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Cc),ic=(n(Vc,Zh=rc),Vc.prototype.jo=function(t){return this.bo.Ko("Listen",t)},Vc.prototype.onMessage=function(t){this.Hs.reset();var e=function(t,e){var n,r,i,o,s,u;if("targetChange"in e){e.targetChange;var a="NO_CHANGE"===(u=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:Rr(),h=e.targetChange.targetIds||[],c=(o=t,s=e.targetChange.resumeToken,o.Le?(Lr(void 0===s||"string"==typeof s),vi.fromBase64String(s||"")):(Lr(void 0===s||s instanceof Uint8Array),vi.fromUint8Array(s||new Uint8Array))),l=e.targetChange.cause,f=l&&(i=void 0===(r=l).code?Wr.UNKNOWN:Ni(r.code),new Qr(i,r.message||""));n=new Xi(a,h,c,f||null)}else if("documentChange"in e){e.documentChange;var p=e.documentChange;p.document,p.document.name,p.document.updateTime;var d=Fo(t,p.document.name),y=xo(p.document.updateTime),v=new Fs({mapValue:{fields:p.document.fields}}),g=new Ks(d,y,v,{}),m=p.targetIds||[],w=p.removedTargetIds||[];n=new Wi(m,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;var b=e.documentDelete;b.document;var E=Fo(t,b.document),I=b.readTime?xo(b.readTime):Yr.min(),A=new $s(E,I),N=b.removedTargetIds||[];n=new Wi([],N,A.key,A)}else if("documentRemove"in e){e.documentRemove;var T=e.documentRemove;T.document;var _=Fo(t,T.document),S=T.removedTargetIds||[];n=new Wi([],S,_,null)}else{if(!("filter"in e))return Rr();e.filter;var R=e.filter;R.targetId;var L=R.count||0,D=new mi(L),P=R.targetId;n=new Qi(P,D)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Yr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Yr.min():xo(e.readTime)}(t);return this.listener.zo(e,n)},Vc.prototype.Ho=function(t){var e,n,r,i,o={};o.database=Bo(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=yi(i)?{documents:{documents:[Go(e,i.path)]}}:{query:function(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Go(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Go(t,r.g()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof fu?function(t){if("=="===t.op){if(Ro(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:Qo(t.field),op:(e=t.op,Po[e]),value:t.value}};var e}(t):Rr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Qo((e=t).field),direction:(n=e.dir,Do[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u,a=(s=t,u=e.limit,s.Le||hi(u)?u:{value:u});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Wo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Wo(e.endAt)),n}(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Mo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Lo(o)},Vc.prototype.Yo=function(t){var e={};e.database=Bo(this.serializer),e.removeTarget=t,this.Lo(e)},Vc),oc=(n(Uc,Jh=rc),Object.defineProperty(Uc.prototype,"Jo",{get:function(){return this.Xo},enumerable:!1,configurable:!0}),Uc.prototype.start=function(){this.Xo=!1,this.lastStreamToken=void 0,Jh.prototype.start.call(this)},Uc.prototype.qo=function(){this.Xo&&this.Zo([])},Uc.prototype.jo=function(t){return this.bo.Ko("Write",t)},Uc.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Xo){this.Hs.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Lr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?xo(t.updateTime):xo(e);n.isEqual(Yr.min())&&(n=xo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new vs(n,r)}(t,i)})):[]),n=xo(t.commitTime);return this.listener.th(n,e)}var r,i;return Lr(!t.writeResults||0===t.writeResults.length),this.Xo=!0,this.listener.eh()},Uc.prototype.nh=function(){var t={};t.database=Bo(this.serializer),this.Lo(t)},Uc.prototype.Zo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Ho(e.serializer,t)})};this.Lo(n)},Uc),sc=(n(kc,Yh=function(){this.Qe=void 0}),kc.prototype.ih=function(){if(this.sh)throw new Qr(Wr.FAILED_PRECONDITION,"The client has already been terminated.")},kc.prototype.rh=function(e,n){var r=this;return this.ih(),this.credentials.getToken().then(function(t){return r.bo.rh(e,n,t)}).catch(function(t){throw t.code===Wr.UNAUTHENTICATED&&r.credentials.To(),t})},kc.prototype.oh=function(e,n){var r=this;return this.ih(),this.credentials.getToken().then(function(t){return r.bo.oh(e,n,t)}).catch(function(t){throw t.code===Wr.UNAUTHENTICATED&&r.credentials.To(),t})},kc),uc=(Oc.prototype.fh=function(r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.dh(),0<this.mutations.length)throw new Qr(Wr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return d(this,void 0,void 0,function(){var i,e,n,o,r;return y(this,function(t){switch(t.label){case 0:return i=Dr(s),e={database:Bo(i.serializer),documents:u.map(function(t){return qo(i.serializer,t)})},[4,i.oh("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=Fo(t,e.found.name),r=xo(e.found.updateTime),i=new Fs({mapValue:{fields:e.found.fields}});return new Ks(n,r,i,{})}(e,n):"missing"in n?function(t,e){Lr(!!e.missing),Lr(!!e.readTime);var n=Fo(t,e.missing),r=xo(e.readTime);return new $s(n,r)}(e,n):Rr());o.set(r.key.toString(),r)}),r=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Lr(!!e),r.push(e)}),r)]}})})}(this.hh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof $s||t instanceof Ks?n.wh(t):Rr()}),e)]}})})},Oc.prototype.set=function(t,e){this.write(e.eo(t,this.Ue(t))),this._h.add(t)},Oc.prototype.update=function(t,e){try{this.write(e.eo(t,this.Th(t)))}catch(t){this.lh=t}this._h.add(t)},Oc.prototype.delete=function(t){this.write([new js(t,this.Ue(t))]),this._h.add(t)},Oc.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:if(this.dh(),this.lh)throw this.lh;return e=this.ah,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ti(Zr.N(e));r.mutations.push(new qs(n,r.Ue(n)))}),[4,function(r,i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=Dr(r),n={database:Bo(e.serializer),writes:i.map(function(t){return Ho(e.serializer,t)})},[4,e.rh("Commit",n)];case 1:return t.sent(),[2]}})})}(this.hh,this.mutations)];case 1:return t.sent(),this.uh=!0,[2]}})})},Oc.prototype.wh=function(t){var e;if(t instanceof Ks)e=t.version;else{if(!(t instanceof $s))throw Rr();e=Yr.min()}var n=this.ah.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Qr(Wr.ABORTED,"Document version changed between two reads.")}else this.ah.set(t.key.toString(),e)},Oc.prototype.Ue=function(t){var e=this.ah.get(t.toString());return!this._h.has(t)&&e?gs.updateTime(e):gs.je()},Oc.prototype.Th=function(t){var e=this.ah.get(t.toString());if(this._h.has(t)||!e)return gs.exists(!0);if(e.isEqual(Yr.min()))throw new Qr(Wr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gs.updateTime(e)},Oc.prototype.write=function(t){this.dh(),this.mutations=this.mutations.concat(t)},Oc.prototype.dh=function(){},Oc),ac=(Pc.prototype.Rh=function(){var t=this;0===this.mh&&(this.Ph("Unknown"),this.Ih=this.Ns.gs("online_state_timeout",1e4,function(){return t.Ih=null,t.Vh("Backend didn't respond within 10 seconds."),t.Ph("Offline"),Promise.resolve()}))},Pc.prototype.yh=function(t){"Online"===this.state?this.Ph("Unknown"):(this.mh++,1<=this.mh&&(this.ph(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.Ph("Offline")))},Pc.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Ah=!1),this.Ph(t)},Pc.prototype.Ph=function(t){t!==this.state&&(this.state=t,this.Eh(t))},Pc.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ah?(_r(e),this.Ah=!1):Tr("OnlineStateTracker",e)},Pc.prototype.ph=function(){null!==this.Ih&&(this.Ih.cancel(),this.Ih=null)},Pc),hc=(Dc.prototype.start=function(){return this.enableNetwork()},Dc.prototype.enableNetwork=function(){return this.Ch.delete(0),this.Wh()},Dc.prototype.Wh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.$h()?(this.jh()?this.Gh():this.kh.set("Unknown"),[4,this.Kh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Dc.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ch.add(0),[4,this.zh()];case 1:return t.sent(),this.kh.set("Offline"),[2]}})})},Dc.prototype.zh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.qh.stop()];case 1:return t.sent(),[4,this.xh.stop()];case 2:return t.sent(),0<this.vh.length&&(Tr("RemoteStore","Stopping write stream with "+this.vh.length+" pending writes"),this.vh=[]),this.Hh(),[2]}})})},Dc.prototype.Yh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Tr("RemoteStore","RemoteStore shutting down."),this.Ch.add(5),[4,this.zh()];case 1:return t.sent(),this.Dh.Yh(),this.kh.set("Unknown"),[2]}})})},Dc.prototype.listen=function(t){this.bh.has(t.targetId)||(this.bh.set(t.targetId,t),this.jh()?this.Gh():this.xh.$o()&&this.Xh(t))},Dc.prototype.Jh=function(t){this.bh.delete(t),this.xh.$o()&&this.Zh(t),0===this.bh.size&&(this.xh.$o()?this.xh.xo():this.$h()&&this.kh.set("Unknown"))},Dc.prototype.Oe=function(t){return this.bh.get(t)||null},Dc.prototype.xe=function(t){return this.ta.xe(t)},Dc.prototype.Xh=function(t){this.Sh.de(t.targetId),this.xh.Ho(t)},Dc.prototype.Zh=function(t){this.Sh.de(t),this.xh.Yo(t)},Dc.prototype.Gh=function(){this.Sh=new eo(this),this.xh.start(),this.kh.Rh()},Dc.prototype.jh=function(){return this.$h()&&!this.xh.Fo()&&0<this.bh.size},Dc.prototype.$h=function(){return 0===this.Ch.size},Dc.prototype.Hh=function(){this.Sh=null},Dc.prototype.Oh=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.bh.forEach(function(t,e){n.Xh(t)}),[2]})})},Dc.prototype.Lh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Hh(),this.jh()?(this.kh.yh(e),this.Gh()):this.kh.set("Unknown"),[2]})})},Dc.prototype.Mh=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:if(this.kh.set("Online"),!(i instanceof Xi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.ea(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Tr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.na(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Wi?this.Sh.Pe(i):i instanceof Qi?this.Sh.Ce(i):this.Sh.pe(i),o.isEqual(Yr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.gh.Xi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.sa(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Tr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.na(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Dc.prototype.na=function(n,r){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!na(n))throw n;return this.Ch.add(1),[4,this.zh()];case 1:return t.sent(),this.kh.set("Offline"),r=r||function(){return e.gh.Xi()},this.Ns.si(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Tr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Ch.delete(1),[4,this.Wh()];case 2:return t.sent(),[2]}})})}),[2]}})})},Dc.prototype.ia=function(e){var n=this;return e().catch(function(t){return n.na(t,e)})},Dc.prototype.sa=function(r){var i=this,t=this.Sh.$e(r);return t.Qt.forEach(function(t,e){if(0<t.resumeToken.H()){var n=i.bh.get(e);n&&i.bh.set(e,n.tt(t.resumeToken,r))}}),t.Wt.forEach(function(t){var e=i.bh.get(t);if(e){i.bh.set(t,e.tt(vi.Y,e.J)),i.Zh(t);var n=new Ei(e.target,t,1,e.sequenceNumber);i.Xh(n)}}),this.ta.Ji(t)},Dc.prototype.ea=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.bh.has(i)?[4,this.ta.ra(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.bh.delete(i),this.Sh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Dc.prototype.Kh=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:e=0<this.vh.length?this.vh[this.vh.length-1].batchId:-1,t.label=1;case 1:if(!this.oa())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.gh.dr(e)];case 3:return null===(n=t.sent())?(0===this.vh.length&&this.qh.xo(),[3,7]):(e=n.batchId,this.ha(n),[3,6]);case 4:return r=t.sent(),[4,this.na(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.aa()&&this.ua(),[2]}})})},Dc.prototype.oa=function(){return this.$h()&&this.vh.length<10},Dc.prototype.ca=function(){return this.vh.length},Dc.prototype.ha=function(t){this.vh.push(t),this.qh.$o()&&this.qh.Jo&&this.qh.Zo(t.mutations)},Dc.prototype.aa=function(){return this.$h()&&!this.qh.Fo()&&0<this.vh.length},Dc.prototype.ua=function(){this.qh.start()},Dc.prototype.Bh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.qh.nh(),[2]})})},Dc.prototype.Qh=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){for(e=0,n=this.vh;e<n.length;e++)r=n[e],this.qh.Zo(r.mutations);return[2]})})},Dc.prototype.th=function(i,o){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.vh.shift(),n=Cu.from(e,i,o),[4,this.ia(function(){return r.ta.la(n)})];case 1:return t.sent(),[4,this.Kh()];case 2:return t.sent(),[2]}})})},Dc.prototype.Uh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.qh.Jo?[4,this._a(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.aa()&&this.ua(),[2]}})})},Dc.prototype._a=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return Ai(n=i.code)&&n!==Wr.ABORTED?(e=this.vh.shift(),this.qh.ko(),[4,this.ia(function(){return r.ta.fa(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.Kh()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Dc.prototype.da=function(){return new uc(this.hh)},Dc.prototype.Nh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ch.add(4),[4,this.zh()];case 1:return t.sent(),this.kh.set("Unknown"),this.qh.ko(),this.xh.ko(),this.Ch.delete(4),[4,this.Wh()];case 2:return t.sent(),[2]}})})},Dc.prototype.wa=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ns.oi(),Tr("RemoteStore","RemoteStore received new credentials"),this.Ch.add(3),[4,this.zh()];case 1:return t.sent(),this.kh.set("Unknown"),[4,this.ta.wa(e)];case 2:return t.sent(),this.Ch.delete(3),[4,this.Wh()];case 3:return t.sent(),[2]}})})},Dc.prototype.Ta=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.Ch.delete(2),[4,this.Wh()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Ch.add(2),[4,this.zh()]);case 3:t.sent(),this.kh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Dc),cc=(Lc.prototype.Ea=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Lc.prototype.ma=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Lc.prototype.Ia=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},Lc),lc=(Rc.prototype.Pa=function(t){},Rc.prototype.Va=function(t,e,n){},Rc.prototype.ya=function(t){return this.Aa.Ea(t),this.Ra[t]||"not-current"},Rc.prototype.pa=function(t,e,n){this.Ra[t]=e},Rc.prototype.ga=function(t){this.Aa.ma(t)},Rc.prototype.va=function(t){return this.Aa.activeTargetIds.has(t)},Rc.prototype.ba=function(t){delete this.Ra[t]},Rc.prototype.Sa=function(){return this.Aa.activeTargetIds},Rc.prototype.Ca=function(t){return this.Aa.activeTargetIds.has(t)},Rc.prototype.start=function(){return this.Aa=new cc,Promise.resolve()},Rc.prototype.Ni=function(t,e,n){},Rc.prototype.Da=function(t){},Rc.prototype.Yh=function(){},Rc.prototype.fs=function(t){},Rc),fc=(Object.defineProperty(Sc.prototype,"Oa",{get:function(){return this.Fa},enumerable:!1,configurable:!0}),Sc.prototype.La=function(t,e){var u=this,a=e?e.Ma:new Ji,h=e?e.xa:this.xa,c=e?e.Mt:this.Mt,l=h,f=!1,p=this.query.En()&&h.size===this.query.limit?h.last():null,d=this.query.mn()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=e instanceof Ks?e:null;r=r&&(hu(u.query,r)?r:null);var i=!!n&&u.Mt.has(n.key),o=!!r&&(r.Ge||u.Mt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.qa(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.ka(r,p)||d&&u.ka(r,d)<0)&&(f=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.En()||this.query.mn())for(;l.size>this.query.limit;){var n=this.query.En()?l.last():l.first();l=l.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{xa:l,Ma:a,Ba:f,Mt:c}},Sc.prototype.qa=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Sc.prototype.Ua=function(t,e,n){var o=this,r=this.xa;this.xa=t.xa,this.Mt=t.Mt;var i=t.Ma.Ot();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ka(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}}var r,i}),this.Qa(n);var s=e?this.Wa():[],u=0===this.Na.size&&this.Ht?1:0,a=u!==this.$a;return this.$a=u,0!==i.length||a?{snapshot:new Zi(this.query,t.xa,r,i,t.Mt,0==u,a,!1),ja:s}:{ja:s}},Sc.prototype.Ga=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Ua({xa:this.xa,Ma:new Ji,Mt:this.Mt,Ba:!1},!1)):{ja:[]}},Sc.prototype.Ka=function(t){return!this.Fa.has(t)&&!!this.xa.has(t)&&!this.xa.get(t).Ge},Sc.prototype.Qa=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Fa=e.Fa.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Fa=e.Fa.delete(t)}),this.Ht=t.Ht)},Sc.prototype.Wa=function(){var e=this;if(!this.Ht)return[];var n=this.Na;this.Na=Bi(),this.xa.forEach(function(t){e.Ka(t.key)&&(e.Na=e.Na.add(t.key))});var r=[];return n.forEach(function(t){e.Na.has(t)||r.push(new Hh(t))}),this.Na.forEach(function(t){n.has(t)||r.push(new zh(t))}),r},Sc.prototype.za=function(t){this.Fa=t.yr,this.Na=Bi();var e=this.La(t.documents);return this.Ua(e,!0)},Sc.prototype.Ha=function(){return Zi.Ut(this.query,this.xa,this.Mt,0===this.$a)},Sc),pc=(_c.prototype.run=function(){this.Xa()},_c.prototype.Xa=function(){var t=this;this.Hs.ys(function(){return d(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=new uc(this.hh),(n=this.Ja(e))&&n.then(function(t){r.Ns.Bs(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Za(t)})})}).catch(function(t){r.Za(t)}),[2]})})})},_c.prototype.Ja=function(t){try{var e=this.updateFunction(t);return!hi(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},_c.prototype.Za=function(t){var e=this;0<this.Ya&&this.tu(t)?(--this.Ya,this.Ns.Bs(function(){return e.Xa(),Promise.resolve()})):this.Os.reject(t)},_c.prototype.tu=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ai(e)},_c),dc=(Object.defineProperty(Tc.prototype,"wu",{get:function(){return!0},enumerable:!1,configurable:!0}),Tc.prototype.subscribe=function(t){this.ru=t},Tc.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:return this.Tu("listen()"),(r=this.ou.get(s))?(e=r.targetId,this.su.ya(e),n=r.view.Ha(),[3,4]):[3,1];case 1:return[4,this.gh.Er(s.Pn())];case 2:return i=t.sent(),o=this.su.ya(i.targetId),e=i.targetId,[4,this.Eu(s,e,"current"===o)];case 3:n=t.sent(),this.wu&&this.nu.listen(i),t.label=4;case 4:return[2,n]}})})},Tc.prototype.Eu=function(u,a,h){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.gh.Pr(u,!0)];case 1:return e=t.sent(),n=new fc(u,e.yr),r=n.La(e.documents),i=$i.zt(a,h&&"Offline"!==this.onlineState),o=n.Ua(r,this.wu,i),this.mu(a,o.ja),s=new Wh(u,a,n),[2,(this.ou.set(u,s),this.hu.has(a)?this.hu.get(a).push(u):this.hu.set(a,[u]),o.snapshot)]}})})},Tc.prototype.Jh=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return this.Tu("unlisten()"),e=this.ou.get(i),1<(n=this.hu.get(e.targetId)).length?[2,(this.hu.set(e.targetId,n.filter(function(t){return!su(t,i)})),void this.ou.delete(i))]:this.wu?(this.su.ga(e.targetId),this.su.Ca(e.targetId)?[3,2]:[4,this.gh.Rr(e.targetId,!1).then(function(){r.su.ba(e.targetId),r.nu.Jh(e.targetId),r.Iu(e.targetId)}).catch(pa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Iu(e.targetId),[4,this.gh.Rr(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Tc.prototype.write=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:this.Tu("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.gh.Mi(i)];case 2:return e=t.sent(),this.su.Pa(e.batchId),this.Au(e.batchId,o),[4,this.Ru(e.Bi)];case 3:return t.sent(),[4,this.nu.Kh()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=aa(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Tc.prototype.runTransaction=function(t,e,n){new pc(t,this.hh,e,n).run()},Tc.prototype.Ji=function(n){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:this.Tu("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.gh.Ji(n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=r.cu.get(e);n&&(Lr(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.eu=!0:0<t.Xt.size?Lr(n.eu):0<t.Jt.size&&(Lr(n.eu),n.eu=!1))}),[4,this.Ru(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,pa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Tc.prototype.Ga=function(r,t){this.Tu("applyOnlineStateChange()");var i=[];this.ou.forEach(function(t,e){var n=e.view.Ga(r);n.snapshot&&i.push(n.snapshot)}),this.ru.Pu(r),this.ru.zo(i),this.onlineState=r},Tc.prototype.ra=function(u,a){return d(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.Tu("rejectListens()"),this.su.pa(u,"rejected",a),e=this.cu.get(u),(n=e&&e.key)?(r=(r=new Ti(ti.P)).nt(n,new $s(n,Yr.min())),i=Bi().add(n),o=new Ki(Yr.min(),new Map,new Oi(Ur),r,i),[4,this.Ji(o)]):[3,2];case 1:return t.sent(),this.uu=this.uu.remove(n),this.cu.delete(u),this.Vu(),[3,4];case 2:return[4,this.gh.Rr(u,!1).then(function(){return s.Iu(u,a)}).catch(pa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Tc.prototype.la=function(r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.Tu("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.gh.Ui(r)];case 2:return n=t.sent(),this.yu(e,null),this.pu(e),this.su.Va(e,"acknowledged"),[4,this.Ru(n)];case 3:return t.sent(),[3,6];case 4:return[4,pa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Tc.prototype.fa=function(n,r){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.Tu("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.gh.Ki(n)];case 2:return e=t.sent(),this.yu(n,r),this.pu(n),this.su.Va(n,"rejected",r),[4,this.Ru(e)];case 3:return t.sent(),[3,6];case 4:return[4,pa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Tc.prototype.gu=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:this.nu.$h()||Tr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.gh.Yi()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.fu.get(e)||[]).push(o),this.fu.set(e,n),[3,4]);case 3:return r=t.sent(),i=aa(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Tc.prototype.pu=function(t){(this.fu.get(t)||[]).forEach(function(t){t.resolve()}),this.fu.delete(t)},Tc.prototype.vu=function(e){this.fu.forEach(function(t){t.forEach(function(t){t.reject(new Qr(Wr.CANCELLED,e))})}),this.fu.clear()},Tc.prototype.Au=function(t,e){var n=this._u[this.currentUser.lo()];n=(n=n||new Ti(Ur)).nt(t,e),this._u[this.currentUser.lo()]=n},Tc.prototype.yu=function(t,e){var n=this._u[this.currentUser.lo()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this._u[this.currentUser.lo()]=n}},Tc.prototype.Iu=function(t,e){var n=this;void 0===e&&(e=null),this.su.ga(t);for(var r=0,i=this.hu.get(t);r<i.length;r++){var o=i[r];this.ou.delete(o),e&&this.ru.bu(o,e)}this.hu.delete(t),this.wu&&this.lu.Nr(t).forEach(function(t){n.lu.Or(t)||n.Su(t)})},Tc.prototype.Su=function(t){var e=this.uu.get(t);null!==e&&(this.nu.Jh(e),this.uu=this.uu.remove(t),this.cu.delete(e),this.Vu())},Tc.prototype.mu=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof zh?(this.lu.lr(i.key,t),this.Cu(i)):i instanceof Hh?(Tr("SyncEngine","Document no longer in limbo: "+i.key),this.lu._r(i.key,t),this.lu.Or(i.key)||this.Su(i.key)):Rr()}},Tc.prototype.Cu=function(t){var e=t.key;this.uu.get(e)||(Tr("SyncEngine","New document in limbo: "+e),this.au.push(e),this.Vu())},Tc.prototype.Vu=function(){for(;0<this.au.length&&this.uu.size<this.iu;){var t=this.au.shift(),e=this.du.next();this.cu.set(e,new Qh(t)),this.uu=this.uu.nt(t,e),this.nu.listen(new Ei(eu.on(t.path).Pn(),e,2,qu.ds))}},Tc.prototype.Du=function(){return this.uu},Tc.prototype.Fu=function(){return this.au},Tc.prototype.Ru=function(r,a){return d(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.ou.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.La(r);return n.Ba?u.gh.Pr(i.query,!1).then(function(t){var e=t.documents;return i.view.La(e,n)}):n}).then(function(t){var e=a&&a.Qt.get(i.targetId),n=i.view.Ua(t,u.wu,e);if(u.mu(i.targetId,n.ja),n.snapshot){u.wu&&u.su.pa(i.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var r=ju.us(i.targetId,n.snapshot);s.push(r)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.ru.zo(o),[4,this.gh.cr(s)];case 2:return t.sent(),[2]}})})},Tc.prototype.Tu=function(t){},Tc.prototype.wa=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Tr("SyncEngine","User change. New user:",n.lo()),[4,this.gh.Ni(n)]);case 1:return e=t.sent(),this.currentUser=n,this.vu("'waitForPendingWrites' promise is rejected due to a user change."),this.su.Ni(n,e.Oi,e.Li),[4,this.Ru(e.xi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Tc.prototype.enableNetwork=function(){return this.nu.enableNetwork()},Tc.prototype.disableNetwork=function(){return this.nu.disableNetwork()},Tc.prototype.xe=function(t){var e=this.cu.get(t);if(e&&e.eu)return Bi().add(e.key);var n=Bi(),r=this.hu.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.ou.get(s);n=n.Dt(u.view.Oa)}return n},Tc),yc=(Nc.prototype.listen=function(u){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.Nu.get(e))||(n=!0,r=new Xh),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.ta.listen(e)];case 2:return i.$u=t.sent(),[3,4];case 3:return o=t.sent(),s=aa(o,"Initialization of query '"+au(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.Nu.set(e,r),r.listeners.push(u),u.Ga(this.onlineState),r.$u&&u.xu(r.$u)&&this.Ou(),[2]}})})},Nc.prototype.Jh=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){return e=o.query,n=!1,(r=this.Nu.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.Nu.delete(e),this.ta.Jh(e))]:[2]})})},Nc.prototype.zo=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Nu.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].xu(i)&&(e=!0);s.$u=i}}e&&this.Ou()},Nc.prototype.bu=function(t,e){var n=this.Nu.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.Nu.delete(t)},Nc.prototype.Pu=function(i){this.onlineState=i;var o=!1;this.Nu.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ga(i)&&(o=!0)}),o&&this.Ou()},Nc.prototype.Lu=function(t){this.ku.add(t),t.next()},Nc.prototype.Mu=function(t){this.ku.delete(t)},Nc.prototype.Ou=function(){this.ku.forEach(function(t){t.next()})},Nc),vc=(Ac.prototype.xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Zi(t.query,t.docs,t.Lt,e,t.Mt,t.fromCache,t.qt,!0)}var o=!1;return this.Bu?this.Qu(t)&&(this.qu.next(t),o=!0):this.Wu(t,this.onlineState)&&(this.ju(t),o=!0),this.Uu=t,o},Ac.prototype.onError=function(t){this.qu.error(t)},Ac.prototype.Ga=function(t){this.onlineState=t;var e=!1;return this.Uu&&!this.Bu&&this.Wu(this.Uu,t)&&(this.ju(this.Uu),e=!0),e},Ac.prototype.Wu=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Gu&&n||t.docs._()&&"Offline"!==e)},Ac.prototype.Qu=function(t){if(0<t.docChanges.length)return!0;var e=this.Uu&&this.Uu.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Ac.prototype.ju=function(t){t=Zi.Ut(t.query,t.docs,t.Mt,t.fromCache),this.Bu=!0,this.qu.next(t)},Ac),gc=(Ic.prototype.$i=function(t){this.Ku=t},Ic.prototype.Zn=function(e,r,i,o){var s=this;return r.Tn()||i.isEqual(Yr.min())?this.zu(e,r):this.Ku.Yn(e,o).next(function(t){var n=s.Hu(r,t);return(r.En()||r.mn())&&s.Ba(r.en,n,o,i)?s.zu(e,r):(Nr()<=p.DEBUG&&Tr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),au(r)),s.Ku.Zn(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Ic.prototype.Hu=function(n,t){var r=new Oi(cu(n));return t.forEach(function(t,e){e instanceof Ks&&hu(n,e)&&(r=r.add(e))}),r},Ic.prototype.Ba=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Ic.prototype.zu=function(t,e){return Nr()<=p.DEBUG&&Tr("IndexFreeQueryEngine","Using full collection scan to execute query:",au(e)),this.Ku.Zn(t,e,Yr.min())},Ic),mc=(Ec.prototype.Ju=function(t){return Mu.resolve(0===this.Qn.length)},Ec.prototype.qi=function(t,e,n,r){var i=this.Yu;this.Yu++,0<this.Qn.length&&this.Qn[this.Qn.length-1];var o=new Vu(i,e,n,r);this.Qn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Xu=this.Xu.add(new ya(a.key,i)),this.Wn.Cs(t,a.key.path.g())}return Mu.resolve(o)},Ec.prototype.zi=function(t,e){return Mu.resolve(this.Zu(e))},Ec.prototype.wr=function(t,e){var n=e+1,r=this.tc(n),i=r<0?0:r;return Mu.resolve(this.Qn.length>i?this.Qn[i]:null)},Ec.prototype.Yi=function(){return Mu.resolve(0===this.Qn.length?-1:this.Yu-1)},Ec.prototype.ki=function(t){return Mu.resolve(this.Qn.slice())},Ec.prototype.Gn=function(t,e){var n=this,r=new ya(e,0),i=new ya(e,Number.POSITIVE_INFINITY),o=[];return this.Xu.bt([r,i],function(t){var e=n.Zu(t.Lr);o.push(e)}),Mu.resolve(o)},Ec.prototype.Jn=function(t,e){var r=this,i=new Oi(Ur);return e.forEach(function(t){var e=new ya(t,0),n=new ya(t,Number.POSITIVE_INFINITY);r.Xu.bt([e,n],function(t){i=i.add(t.Lr)})}),Mu.resolve(this.ec(i))},Ec.prototype.rs=function(t,e){var n=e.path,r=n.length+1,i=n;ti.W(i)||(i=i.child(""));var o=new ya(new ti(i),0),s=new Oi(Ur);return this.Xu.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===r&&(s=s.add(t.Lr)),!0)},o),Mu.resolve(this.ec(s))},Ec.prototype.ec=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Zu(t);null!==e&&r.push(e)}),r},Ec.prototype.Hi=function(n,r){var i=this;Lr(0===this.nc(r.batchId,"removed")),this.Qn.shift();var o=this.Xu;return Mu.forEach(r.mutations,function(t){var e=new ya(t.key,r.batchId);return o=o.delete(e),i.hr.sc(n,t.key)}).next(function(){i.Xu=o})},Ec.prototype.ic=function(t){},Ec.prototype.Or=function(t,e){var n=new ya(e,0),r=this.Xu.Ct(n);return Mu.resolve(e.isEqual(r&&r.key))},Ec.prototype.Gi=function(t){return this.Qn.length,Mu.resolve()},Ec.prototype.nc=function(t,e){return this.tc(t)},Ec.prototype.tc=function(t){return 0===this.Qn.length?0:t-this.Qn[0].batchId},Ec.prototype.Zu=function(t){var e=this.tc(t);return e<0||e>=this.Qn.length?null:this.Qn[e]},Ec),wc=(bc.prototype.rr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.rc(e);return this.docs=this.docs.nt(r,{oc:e,size:s,readTime:n}),this.size+=s-o,this.Wn.Cs(t,r.path.g())},bc.prototype.ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},bc.prototype.zn=function(t,e){var n=this.docs.get(e);return Mu.resolve(n?n.oc:null)},bc.prototype.getEntries=function(t,e){var n=this,r=xi();return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.oc:null)}),Mu.resolve(r)},bc.prototype.Zn=function(t,e,n){for(var r=qi(),i=new ti(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.oc,c=a.readTime;if(!e.path.C(u.path))break;c.o(n)<=0||h instanceof Ks&&hu(e,h)&&(r=r.nt(h.key,h))}return Mu.resolve(r)},bc.prototype.hc=function(t,e){return Mu.forEach(this.docs,function(t){return e(t)})},bc.prototype.Qi=function(t){return new bc.ac(this)},bc.prototype.uc=function(t){return Mu.resolve(this.size)},bc);function bc(t,e){this.Wn=t,this.rc=e,this.docs=new Ti(ti.P),this.size=0}function Ec(t,e){this.Wn=t,this.hr=e,this.Qn=[],this.Yu=1,this.Xu=new Oi(ya.br)}function Ic(){}function Ac(t,e,n){this.query=t,this.qu=e,this.Bu=!1,this.Uu=null,this.onlineState="Unknown",this.options=n||{}}function Nc(t){this.ta=t,this.Nu=new Hr(function(t){return uu(t)},su),this.onlineState="Unknown",this.ku=new Set,this.ta.subscribe(this)}function Tc(t,e,n,r,i,o){this.gh=t,this.nu=e,this.hh=n,this.su=r,this.currentUser=i,this.iu=o,this.ru=null,this.ou=new Hr(function(t){return uu(t)},su),this.hu=new Map,this.au=[],this.uu=new Ti(ti.P),this.cu=new Map,this.lu=new da,this._u={},this.fu=new Map,this.du=Zu.$s(),this.onlineState="Unknown"}function _c(t,e,n,r){this.Ns=t,this.hh=e,this.updateFunction=n,this.Os=r,this.Ya=5,this.Hs=new Xu(this.Ns,"transaction_retry")}function Sc(t,e){this.query=t,this.Fa=e,this.$a=null,this.Ht=!1,this.Na=Bi(),this.Mt=Bi(),this.ka=cu(t),this.xa=new Yi(this.ka)}function Rc(){this.Aa=new cc,this.Ra={},this.ta=null,this.Eh=null,this.cs=null}function Lc(){this.activeTargetIds=Hi()}function Dc(t,e,n,r,i){var o,s,u,a,h,c,l,f,p=this;this.gh=t,this.hh=e,this.Ns=n,this.vh=[],this.bh=new Map,this.Sh=null,this.Ch=new Set,this.Dh=i,this.Dh.Fh(function(t){n.Bs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.$h()?(Tr("RemoteStore","Restarting streams for network reachability change."),[4,this.Nh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.kh=new ac(n,r),this.xh=(h=this.hh,c=n,l={Go:this.Oh.bind(this),Bo:this.Lh.bind(this),zo:this.Mh.bind(this)},f=Dr(h),new ic(c,f.bo,f.credentials,f.serializer,l)),this.qh=(o=this.hh,s=n,u={Go:this.Bh.bind(this),Bo:this.Uh.bind(this),eh:this.Qh.bind(this),th:this.th.bind(this)},a=Dr(o),new oc(s,a.bo,a.credentials,a.serializer,u))}function Pc(t,e){this.Ns=t,this.Eh=e,this.state="Unknown",this.mh=0,this.Ih=null,this.Ah=!0}function Oc(t){this.hh=t,this.ah=new Map,this.mutations=[],this.uh=!1,this.lh=null,this._h=new Set}function kc(t,e,n){var r=this;return(r=Yh.call(this)||this).bo=t,r.credentials=e,r.serializer=n,r.sh=!1,r}function Uc(t,e,n,r,i){var o=this;return(o=Jh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Xo=!1,o}function Vc(t,e,n,r,i){var o=this;return(o=Zh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Cc(t,e,n,r,i,o){this.ws=t,this.vo=n,this.bo=r,this.So=i,this.listener=o,this.state=0,this.Co=0,this.Do=null,this.stream=null,this.Hs=new Xu(t,e)}function Mc(t,e){this.Vo=t,this.yo=e}function xc(t,e){this.Vo=t,this.yo=e,this.type="FirstParty",this.user=Fh.fo}function jc(t){var e=this;this.Io=null,this.currentUser=Fh.UNAUTHENTICATED,this.Ao=!1,this.Ro=0,this.wo=null,this.forceRefresh=!1,this.Io=function(){e.Ro++,e.currentUser=e.Po(),e.Ao=!0,e.wo&&e.wo(e.currentUser)},this.Ro=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Io):(this.Io(null),t.get().then(function(t){e.auth=t,e.Io&&e.auth.addAuthTokenListener(e.Io)},function(){}))}function qc(){this.wo=null}function Fc(t){var e=this;return(e=Kh.call(this)||this).wc=t,e}function Gc(){this.Bi=new Hr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.cc=!1}wc.ac=(Object.defineProperty(Gc.prototype,"readTime",{get:function(){return this.lc},set:function(t){this.lc=t},enumerable:!1,configurable:!0}),Gc.prototype.rr=function(t,e){this._c(),this.readTime=e,this.Bi.set(t.key,t)},Gc.prototype.ir=function(t,e){this._c(),e&&(this.readTime=e),this.Bi.set(t,null)},Gc.prototype.zn=function(t,e){this._c();var n=this.Bi.get(e);return void 0!==n?Mu.resolve(n):this.fc(t,e)},Gc.prototype.getEntries=function(t,e){return this.dc(t,e)},Gc.prototype.apply=function(t){return this._c(),this.cc=!0,this.Ua(t)},Gc.prototype._c=function(){},n(Fc,Kh=Gc),Fc.prototype.Ua=function(n){var r=this,i=[];return this.Bi.forEach(function(t,e){e?i.push(r.wc.rr(n,e,r.readTime)):r.wc.ir(t)}),Mu.qn(i)},Fc.prototype.fc=function(t,e){return this.wc.zn(t,e)},Fc.prototype.dc=function(t,e){return this.wc.getEntries(t,e)},Fc);var Bc,zc=(yl.prototype.ge=function(t,n){return this.Tc.forEach(function(t,e){return n(e)}),Mu.resolve()},yl.prototype.Xi=function(t){return Mu.resolve(this.lastRemoteSnapshotVersion)},yl.prototype.Ac=function(t){return Mu.resolve(this.Ec)},yl.prototype.Ir=function(t){return this.highestTargetId=this.Ic.next(),Mu.resolve(this.highestTargetId)},yl.prototype.ar=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ec&&(this.Ec=e),Mu.resolve()},yl.prototype.Rc=function(t){this.Tc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ic=new Zu(e),this.highestTargetId=e),t.sequenceNumber>this.Ec&&(this.Ec=t.sequenceNumber)},yl.prototype.Ar=function(t,e){return this.Rc(e),this.targetCount+=1,Mu.resolve()},yl.prototype.sr=function(t,e){return this.Rc(e),Mu.resolve()},yl.prototype.Pc=function(t,e){return this.Tc.delete(e.target),this.mc.Nr(e.targetId),--this.targetCount,Mu.resolve()},yl.prototype.Vc=function(n,r,i){var o=this,s=0,u=[];return this.Tc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Tc.delete(t),u.push(o.yc(n,e.targetId)),s++)}),Mu.qn(u).next(function(){return s})},yl.prototype.pc=function(t){return Mu.resolve(this.targetCount)},yl.prototype.mr=function(t,e){var n=this.Tc.get(e)||null;return Mu.resolve(n)},yl.prototype.tr=function(t,e,n){return this.mc.Dr(e,n),Mu.resolve()},yl.prototype.Zi=function(e,t,n){this.mc.$r(t,n);var r=this.persistence.hr,i=[];return r&&t.forEach(function(t){i.push(r.sc(e,t))}),Mu.qn(i)},yl.prototype.yc=function(t,e){return this.mc.Nr(e),Mu.resolve()},yl.prototype.Vr=function(t,e){var n=this.mc.xr(e);return Mu.resolve(n)},yl.prototype.Or=function(t,e){return Mu.resolve(this.mc.Or(e))},yl),Hc=(dl.prototype.start=function(){return Promise.resolve()},dl.prototype.Yh=function(){return this.bc=!1,Promise.resolve()},Object.defineProperty(dl.prototype,"Cc",{get:function(){return this.bc},enumerable:!1,configurable:!0}),dl.prototype.Dc=function(){},dl.prototype.Fi=function(){return this.Wn},dl.prototype.gi=function(t){var e=this.gc[t.lo()];return e||(e=new mc(this.Wn,this.hr),this.gc[t.lo()]=e),e},dl.prototype.Ci=function(){return this.Si},dl.prototype.bi=function(){return this.Un},dl.prototype.runTransaction=function(t,e,n){var r=this;Tr("MemoryPersistence","Starting transaction:",t);var i=new Wc(this.vc.next());return this.hr.Fc(),n(i).next(function(t){return r.hr.$c(i).next(function(){return t})}).Ln().then(function(t){return i.Nc(),t})},dl.prototype.kc=function(e,n){return Mu.Bn(Object.values(this.gc).map(function(t){return function(){return t.Or(e,n)}}))},dl),Wc=(pl.prototype.Oc=function(t){this.xc.push(t)},pl.prototype.Nc=function(){this.xc.forEach(function(t){return t()})},n(fl,Bc=pl),fl),Qc=(ll.qc=function(t){return new ll(t)},Object.defineProperty(ll.prototype,"Bc",{get:function(){if(this.Mc)return this.Mc;throw Rr()},enumerable:!1,configurable:!0}),ll.prototype.lr=function(t,e,n){return this.Lc.lr(n,e),this.Bc.delete(n),Mu.resolve()},ll.prototype._r=function(t,e,n){return this.Lc._r(n,e),this.Bc.add(n),Mu.resolve()},ll.prototype.sc=function(t,e){return this.Bc.add(e),Mu.resolve()},ll.prototype.removeTarget=function(t,e){var n=this;this.Lc.Nr(e.targetId).forEach(function(t){return n.Bc.add(t)});var r=this.persistence.Ci();return r.Vr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Bc.add(t)})}).next(function(){return r.Pc(t,e)})},ll.prototype.Fc=function(){this.Mc=new Set},ll.prototype.$c=function(t){var n=this,r=this.persistence.bi().Qi();return Mu.forEach(this.Bc,function(e){return n.Uc(t,e).next(function(t){t||r.ir(e)})}).next(function(){return n.Mc=null,r.apply(t)})},ll.prototype.or=function(t,e){var n=this;return this.Uc(t,e).next(function(t){t?n.Bc.delete(e):n.Bc.add(e)})},ll.prototype.Sc=function(t){return 0},ll.prototype.Uc=function(t,e){var n=this;return Mu.Bn([function(){return Mu.resolve(n.Lc.Or(e))},function(){return n.persistence.Ci().Or(t,e)},function(){return n.persistence.kc(t,e)}])},ll),Xc=(cl.prototype.Go=function(t){this.jc=t},cl.prototype.Bo=function(t){this.Gc=t},cl.prototype.onMessage=function(t){this.Kc=t},cl.prototype.close=function(){this.Wc()},cl.prototype.send=function(t){this.Qc(t)},cl.prototype.zc=function(){this.jc()},cl.prototype.Hc=function(t){this.Gc(t)},cl.prototype.Yc=function(t){this.Kc(t)},cl),Yc={BatchGetDocuments:"batchGet",Commit:"commit"},Jc="gl-js/ fire/"+Ir,Zc=(hl.prototype.Jc=function(t,e){if(e)for(var n in e.do)e.do.hasOwnProperty(n)&&(t[n]=e.do[n]);t["X-Goog-Api-Client"]=Jc},hl.prototype.rh=function(a,r,i){var h=this,c=this.Zc(a);return new Promise(function(o,s){var u=new wr;u.listenOnce(gr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case vr.NO_ERROR:var t=u.getResponseJson();Tr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case vr.TIMEOUT:Tr("Connection",'RPC "'+a+'" timed out'),s(new Qr(Wr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=u.getStatus();if(Tr("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var r=(i=n.status.toLowerCase().replace("_","-"),0<=Object.values(Wr).indexOf(i)?i:Wr.UNKNOWN);s(new Qr(r,n.message))}else s(new Qr(Wr.UNKNOWN,"Server responded with status "+u.getStatus()))}else Tr("Connection",'RPC "'+a+'" failed'),s(new Qr(Wr.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{Tr("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Tr("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Jc(n,i),u.send(c,"POST",e,n,15)})},hl.prototype.oh=function(t,e,n){return this.rh(t,e,n)},hl.prototype.Ko=function(t,e){var n,r,i=[this.Xc,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=yr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Jc(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Tr("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new Xc({Qc:function(t){l?Tr("Connection","Not sending because WebChannel is closed:",t):(c||(Tr("Connection","Opening WebChannel transport."),h.open(),c=!0),Tr("Connection","WebChannel sending:",t),h.send(t))},Wc:function(){return h.close()}});return a(mr.EventType.OPEN,function(){l||Tr("Connection","WebChannel transport opened.")}),a(mr.EventType.CLOSE,function(){l||(l=!0,Tr("Connection","WebChannel transport closed"),f.Hc())}),a(mr.EventType.ERROR,function(t){l||(l=!0,function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ar.logLevel<=p.WARN){var r=e.map(Sr);Ar.warn.apply(Ar,v(["Firestore ("+Ir+"): Connection"],r))}}("Connection","WebChannel transport errored:",t),f.Hc(new Qr(Wr.UNAVAILABLE,"The operation could not be completed")))}),a(mr.EventType.MESSAGE,function(t){var e;if(!l){var n=t.data[0];Lr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Tr("Connection","WebChannel received error:",r);var i=r.status,o=function(){var t=wi[i];if(void 0!==t)return Ni(t)}(),s=r.message;void 0===o&&(o=Wr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.Hc(new Qr(o,s)),h.close()}else Tr("Connection","WebChannel received:",n),f.Yc(n)}}),setTimeout(function(){f.zc()},0),f},hl.prototype.Zc=function(t){var e=Yc[t];return this.Xc+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},hl),Kc=(al.prototype.Fh=function(t){this.il.push(t)},al.prototype.Yh=function(){window.removeEventListener("online",this.tl),window.removeEventListener("offline",this.nl)},al.prototype.rl=function(){window.addEventListener("online",this.tl),window.addEventListener("offline",this.nl)},al.prototype.el=function(){Tr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.il;t<e.length;t++)(0,e[t])(0)},al.prototype.sl=function(){Tr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.il;t<e.length;t++)(0,e[t])(1)},al.ol=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},al),$c=(ul.prototype.Fh=function(t){},ul.prototype.Yh=function(){},ul),tl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",el=(sl.prototype.initialize=function(n){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.su=this.hl(n),this.persistence=this.al(n),[4,this.persistence.start()];case 1:return t.sent(),this.ul=this.cl(n),this.gh=this.ll(n),this.nu=this._l(n),this.ta=this.fl(n),this.dl=this.wl(n),this.su.Eh=function(t){return e.ta.Ga(t,1)},this.nu.ta=this.ta,[4,this.gh.start()];case 2:return t.sent(),[4,this.su.start()];case 3:return t.sent(),[4,this.nu.start()];case 4:return t.sent(),[4,this.nu.Ta(this.ta.wu)];case 5:return t.sent(),[2]}})})},sl.prototype.wl=function(t){return new yc(this.ta)},sl.prototype.cl=function(t){return null},sl.prototype.ll=function(t){return e=this.persistence,n=new gc,r=t.Tl,new la(e,n,r);var e,n,r},sl.prototype.al=function(t){if(t.ml.El)throw new Qr(Wr.FAILED_PRECONDITION,tl);return new Hc(Qc.qc)},sl.prototype._l=function(t){var e=this;return new hc(this.gh,t.hh,t.Ns,function(t){return e.ta.Ga(t,0)},new(Kc.ol()?Kc:$c))},sl.prototype.hl=function(t){return new lc},sl.prototype.fl=function(t){return e=this.gh,n=this.nu,r=t.hh,i=this.su,o=t.Tl,s=t.iu,new dc(e,n,r,i,o,s);var e,n,r,i,o,s},sl.prototype.clearPersistence=function(t,e){throw new Qr(Wr.FAILED_PRECONDITION,tl)},sl),nl=(ol.prototype.start=function(t,e,n){var r=this;this.ih(),this.Il=t;var i=new Qu,o=new Qu,s=!1;return this.credentials.Eo(function(t){if(!s)return s=!0,Tr("FirestoreClient","Initializing. user=",t.uid),r.Al(e,n,t,o).then(i.resolve,i.reject);r.Ns.si(function(){return r.nu.wa(t)})}),this.Ns.Bs(function(){return i.promise}),o.promise},ol.prototype.enableNetwork=function(){var t=this;return this.ih(),this.Ns.enqueue(function(){return t.ta.enableNetwork()})},ol.prototype.Al=function(h,c,l,f){return d(this,void 0,void 0,function(){var r,i,o,s,u,a=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,(u=this.Il,Promise.resolve(new Zc(u)))];case 1:return r=t.sent(),i=gh(this.Il.s),e=r,n=this.credentials,o=new sc(e,n,i),[4,h.initialize({Ns:this.Ns,Il:this.Il,hh:o,clientId:this.clientId,Tl:l,iu:100,ml:c})];case 2:return t.sent(),this.persistence=h.persistence,this.su=h.su,this.gh=h.gh,this.nu=h.nu,this.ta=h.ta,this.ul=h.ul,this.Rl=h.dl,this.persistence.Dc(function(){return d(a,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),f.resolve(),[3,4];case 3:if(s=t.sent(),f.reject(s),!this.Pl(s))throw s;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),this.Al(new el,{El:!1},l,f))];case 4:return[2]}var e,n})})},ol.prototype.Pl=function(t){return"FirebaseError"===t.name?t.code===Wr.FAILED_PRECONDITION||t.code===Wr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},ol.prototype.ih=function(){if(this.Ns.Xs)throw new Qr(Wr.FAILED_PRECONDITION,"The client has already been terminated.")},ol.prototype.disableNetwork=function(){var t=this;return this.ih(),this.Ns.enqueue(function(){return t.ta.disableNetwork()})},ol.prototype.terminate=function(){var t=this;return this.Ns.ni(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ul&&this.ul.stop(),[4,this.nu.Yh()];case 1:return t.sent(),[4,this.su.Yh()];case 2:return t.sent(),[4,this.persistence.Yh()];case 3:return t.sent(),this.credentials.mo(),[2]}})})})},ol.prototype.waitForPendingWrites=function(){var t=this;this.ih();var e=new Qu;return this.Ns.Bs(function(){return t.ta.gu(e)}),e.promise},ol.prototype.listen=function(t,e,n){var r=this;this.ih();var i=new vc(t,e,n);return this.Ns.Bs(function(){return r.Rl.listen(i)}),i},ol.prototype.Jh=function(t){var e=this;this.Vl||this.Ns.Bs(function(){return e.Rl.Jh(t)})},ol.prototype.yl=function(o){return d(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){switch(t.label){case 0:return this.ih(),i=new Qu,[4,this.Ns.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.gh.Tr(o)];case 1:return(e=t.sent())instanceof Ks?i.resolve(e):e instanceof $s?i.resolve(null):i.reject(new Qr(Wr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=aa(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},ol.prototype.pl=function(a){return d(this,void 0,void 0,function(){var u,e=this;return y(this,function(t){switch(t.label){case 0:return this.ih(),u=new Qu,[4,this.Ns.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.gh.Pr(a,!0)];case 1:return e=t.sent(),n=new fc(a,e.yr),r=n.La(e.documents),i=n.Ua(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=aa(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},ol.prototype.write=function(t){var e=this;this.ih();var n=new Qu;return this.Ns.Bs(function(){return e.ta.write(t,n)}),n.promise},ol.prototype.s=function(){return this.Il.s},ol.prototype.Lu=function(t){var e=this;this.ih(),this.Ns.Bs(function(){return e.Rl.Lu(t),Promise.resolve()})},ol.prototype.Mu=function(t){var e=this;this.Vl||this.Ns.Bs(function(){return e.Rl.Mu(t),Promise.resolve()})},Object.defineProperty(ol.prototype,"Vl",{get:function(){return this.Ns.Xs},enumerable:!1,configurable:!0}),ol.prototype.transaction=function(t){var e=this;this.ih();var n=new Qu;return this.Ns.Bs(function(){return e.ta.runTransaction(e.Ns,t,n),Promise.resolve()}),n.promise},ol),rl=(il.prototype.next=function(t){this.gl(this.observer.next,t)},il.prototype.error=function(t){this.gl(this.observer.error,t)},il.prototype.vl=function(){this.muted=!0},il.prototype.gl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},il);function il(t){this.observer=t,this.muted=!1}function ol(t,e){this.credentials=t,this.Ns=e,this.clientId=Or.t()}function sl(){}function ul(){}function al(){var t=this;this.tl=function(){return t.el()},this.nl=function(){return t.sl()},this.il=[],this.rl()}function hl(t){this.s=t.s;var e=t.ssl?"https":"http";this.Xc=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function cl(t){this.Qc=t.Qc,this.Wc=t.Wc}function ll(t){this.persistence=t,this.Lc=new da,this.Mc=null}function fl(t){var e=this;return(e=Bc.call(this)||this).er=t,e}function pl(){this.xc=[]}function dl(t){var e=this;this.gc={},this.vc=new qu(0),this.bc=!1,this.bc=!0,this.hr=t(this),this.Si=new zc(this),this.Wn=new Yu,this.Un=new wc(this.Wn,function(t){return e.hr.Sc(t)})}function yl(t){this.persistence=t,this.Tc=new Hr(function(t){return pi(t)},di),this.lastRemoteSnapshotVersion=Yr.min(),this.highestTargetId=0,this.Ec=0,this.mc=new da,this.targetCount=0,this.Ic=Zu.Fs()}function vl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var gl=(Al.prototype.Cl=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.Dl(t.timestampValue);case 4:return this.Fl(t);case 5:return t.stringValue;case 6:return new Fa(Ao(t.bytesValue));case 7:return this.$l(t.referenceValue);case 8:return this.Nl(t.geoPointValue);case 9:return this.kl(t.arrayValue);case 10:return this.xl(t.mapValue);default:throw Rr()}},Al.prototype.xl=function(t){var n=this,r={};return qr(t.fields||{},function(t,e){r[t]=n.Cl(e)}),r},Al.prototype.Nl=function(t){return new hh(Io(t.latitude),Io(t.longitude))},Al.prototype.kl=function(t){var e=this;return(t.values||[]).map(function(t){return e.Cl(t)})},Al.prototype.Fl=function(t){switch(this.bl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return lo(n)?t(n):n}(t);return null==e?null:this.Cl(e);case"estimate":return this.Dl(fo(t));default:return null}},Al.prototype.Dl=function(t){var e=Eo(t),n=new Xr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Al.prototype.$l=function(t){var e=Zr.N(t);Lr(Xo(e));var n=new Mr(e.get(1),e.get(3)),r=new ti(e.p(5));return n.isEqual(this.s)||_r("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Sl(r)},Al),ml=ha.Ei,wl=(Il.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Il),bl=(Object.defineProperty(El.prototype,"Gl",{get:function(){return this.Kl||(this.Kl=new _h(this.Jr,this.jl.ignoreUndefinedProperties)),this.Kl},enumerable:!1,configurable:!0}),El.prototype.settings=function(t){wa("Firestore.settings",arguments,1),Ia("Firestore.settings","object",1,t);var e=new wl(t);if(this.ql&&!this.jl.isEqual(e))throw new Qr(Wr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.jl=e).credentials&&(this.Ql=function(t){if(!t)return new $h;switch(t.type){case"gapi":var e=t.zl;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new nc(e,t.yo||"0");case"provider":return t.zl;default:throw new Qr(Wr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},El.prototype.enableNetwork=function(){return this.Ml(),this.ql.enableNetwork()},El.prototype.disableNetwork=function(){return this.Ml(),this.ql.disableNetwork()},El.prototype.enablePersistence=function(t){var e,n;if(this.ql)throw new Qr(Wr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&_r("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Qr(Wr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Hl(this.Wl,{El:!0,cacheSizeBytes:this.jl.cacheSizeBytes,synchronizeTabs:r,Yl:i})},El.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.ql&&!this.ql.Vl)throw new Qr(Wr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Qu,[2,(this.Ll.Js(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Wl.clearPersistence(this.Jr,this.Ul)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},El.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(El.prototype,"Xl",{get:function(){return this.Ml(),this.ql.Vl},enumerable:!1,configurable:!0}),El.prototype.waitForPendingWrites=function(){return this.Ml(),this.ql.waitForPendingWrites()},El.prototype.onSnapshotsInSync=function(t){if(this.Ml(),vl(t))return Nl(this.ql,t);Ia("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return Nl(this.ql,e)},El.prototype.Ml=function(){return this.ql||this.Hl(new el,{El:!1}),this.ql},El.prototype.Jl=function(){return new Cr(this.Jr,this.Ul,this.jl.host,this.jl.ssl,this.jl.forceLongPolling)},El.prototype.Hl=function(t,e){var n=this.Jl();return this.ql=new nl(this.Ql,this.Ll),this.ql.start(n,t,e)},El.Bl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Qr(Wr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Qr(Wr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Mr(n)},Object.defineProperty(El.prototype,"app",{get:function(){if(!this.Ol)throw new Qr(Wr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Ol},enumerable:!1,configurable:!0}),El.prototype.collection=function(t){return wa("Firestore.collection",arguments,1),Ia("Firestore.collection","non-empty string",1,t),this.Ml(),new Xl(Zr.N(t),this,null)},El.prototype.doc=function(t){return wa("Firestore.doc",arguments,1),Ia("Firestore.doc","non-empty string",1,t),this.Ml(),Rl.Zl(Zr.N(t),this,null)},El.prototype.collectionGroup=function(t){if(wa("Firestore.collectionGroup",arguments,1),Ia("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Ml(),new Gl(new eu(Zr.k(),t),this,null)},El.prototype.runTransaction=function(e){var n=this;return wa("Firestore.runTransaction",arguments,1),Ia("Firestore.runTransaction","function",1,e),this.Ml().transaction(function(t){return e(new _l(n,t))})},El.prototype.batch=function(){return this.Ml(),new Sl(this)},Object.defineProperty(El,"logLevel",{get:function(){switch(Nr()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),El.setLogLevel=function(t){wa("Firestore.setLogLevel",arguments,1),Sa("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ar.setLogLevel(t)},El.prototype.t_=function(){return this.jl.timestampsInSnapshots},El);function El(t,e,n){var r=this;if(void 0===n&&(n=new el),this.Ol=null,this.Ll=new oa,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ml(),[4,this.ql.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.Ol=i,this.Jr=El.Bl(i),this.Ul=i.name,this.Ql=new tc(e)}else{var o=t;if(!o.projectId)throw new Qr(Wr.INVALID_ARGUMENT,"Must provide projectId");this.Jr=new Mr(o.projectId,o.database),this.Ul="[DEFAULT]",this.Ql=new $h}this.Wl=n,this.jl=new wl({})}function Il(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Qr(Wr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Na("settings","non-empty string","host",t.host),this.host=t.host,Ta("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Oa("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Ta("settings","object","credentials",t.credentials),this.credentials=t.credentials,Ta("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Ta("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?_r("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&_r("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Ta("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ha.Ii;else{if(t.cacheSizeBytes!==ml&&t.cacheSizeBytes<ha.mi)throw new Qr(Wr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ha.mi);this.cacheSizeBytes=t.cacheSizeBytes}Ta("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Al(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.bl=n,this.Sl=r}function Nl(t,e){var n=new rl({next:function(){e.next&&e.next()},error:function(t){throw Rr()}});return t.Lu(n),function(){n.vl(),t.Mu(n)}}var Tl,_l=(Pl.prototype.get=function(t){var n=this;wa("Transaction.get",arguments,1);var r=tf("Transaction.get",t,this.e_);return this.n_.fh([r.Zr]).then(function(t){if(!t||1!==t.length)return Rr();var e=t[0];if(e instanceof $s)return new Vl(n.e_,r.Zr,null,!1,!1,r.to);if(e instanceof Ks)return new Vl(n.e_,r.Zr,e,!1,!1,r.to);throw Rr()})},Pl.prototype.set=function(t,e,n){Ea("Transaction.set",arguments,2,3);var r=tf("Transaction.set",t,this.e_);n=Zl("Transaction.set",n);var i=ef(r.to,e,n),o=Lh(this.e_.Gl,"Transaction.set",r.Zr,i,null!==r.to,n);return this.n_.set(r.Zr,o),this},Pl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Ba?(ba("Transaction.update",arguments,3),r=tf("Transaction.update",t,this.e_),Ph(this.e_.Gl,"Transaction.update",r.Zr,e,n,o)):(wa("Transaction.update",arguments,2),r=tf("Transaction.update",t,this.e_),Dh(this.e_.Gl,"Transaction.update",r.Zr,e)),this.n_.update(r.Zr,i),this},Pl.prototype.delete=function(t){wa("Transaction.delete",arguments,1);var e=tf("Transaction.delete",t,this.e_);return this.n_.delete(e.Zr),this},Pl),Sl=(Dl.prototype.set=function(t,e,n){Ea("WriteBatch.set",arguments,2,3),this.r_();var r=tf("WriteBatch.set",t,this.e_);n=Zl("WriteBatch.set",n);var i=ef(r.to,e,n),o=Lh(this.e_.Gl,"WriteBatch.set",r.Zr,i,null!==r.to,n);return this.s_=this.s_.concat(o.eo(r.Zr,gs.je())),this},Dl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.r_(),i="string"==typeof e||e instanceof Ba?(ba("WriteBatch.update",arguments,3),r=tf("WriteBatch.update",t,this.e_),Ph(this.e_.Gl,"WriteBatch.update",r.Zr,e,n,o)):(wa("WriteBatch.update",arguments,2),r=tf("WriteBatch.update",t,this.e_),Dh(this.e_.Gl,"WriteBatch.update",r.Zr,e)),this.s_=this.s_.concat(i.eo(r.Zr,gs.exists(!0))),this},Dl.prototype.delete=function(t){wa("WriteBatch.delete",arguments,1),this.r_();var e=tf("WriteBatch.delete",t,this.e_);return this.s_=this.s_.concat(new js(e.Zr,gs.je())),this},Dl.prototype.commit=function(){return this.r_(),this.i_=!0,0<this.s_.length?this.e_.Ml().write(this.s_):Promise.resolve()},Dl.prototype.r_=function(){if(this.i_)throw new Qr(Wr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Dl),Rl=(n(Ll,Tl=wh),Ll.Zl=function(t,e,n){if(t.length%2!=0)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new Ll(new ti(t),e,n)},Object.defineProperty(Ll.prototype,"id",{get:function(){return this.Zr.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Ll.prototype,"parent",{get:function(){return new Xl(this.Zr.path.g(),this.firestore,this.to)},enumerable:!1,configurable:!0}),Object.defineProperty(Ll.prototype,"path",{get:function(){return this.Zr.path.$()},enumerable:!1,configurable:!0}),Ll.prototype.collection=function(t){if(wa("DocumentReference.collection",arguments,1),Ia("DocumentReference.collection","non-empty string",1,t),!t)throw new Qr(Wr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Zr.N(t);return new Xl(this.Zr.path.child(e),this.firestore,null)},Ll.prototype.isEqual=function(t){if(!(t instanceof Ll))throw ka("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Zr.isEqual(t.Zr)&&this.to===t.to},Ll.prototype.set=function(t,e){Ea("DocumentReference.set",arguments,1,2),e=Zl("DocumentReference.set",e);var n=ef(this.to,t,e),r=Lh(this.firestore.Gl,"DocumentReference.set",this.Zr,n,null!==this.to,e);return this.ql.write(r.eo(this.Zr,gs.je()))},Ll.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Ba?(ba("DocumentReference.update",arguments,2),Ph(this.firestore.Gl,"DocumentReference.update",this.Zr,t,e,r)):(wa("DocumentReference.update",arguments,1),Dh(this.firestore.Gl,"DocumentReference.update",this.Zr,t)),this.ql.write(n.eo(this.Zr,gs.exists(!0)))},Ll.prototype.delete=function(){return wa("DocumentReference.delete",arguments,0),this.ql.write([new js(this.Zr,gs.je())])},Ll.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ea("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||vl(i[u])||(Oa("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Ta("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(vl(i[u])){var h=i[u];i[u]=null===(t=h.next)||void 0===t?void 0:t.bind(h),i[u+1]=null===(e=h.error)||void 0===e?void 0:e.bind(h),i[u+2]=null===(n=h.complete)||void 0===n?void 0:n.bind(h)}else Ia("DocumentReference.onSnapshot","function",u,i[u]),Aa("DocumentReference.onSnapshot","function",u+1,i[u+1]),Aa("DocumentReference.onSnapshot","function",u+2,i[u+2]);var c={next:function(t){i[u]&&i[u](r.o_(t))},error:i[u+1],complete:i[u+2]};return Ol(this.ql,this.Zr,a,c)},Ll.prototype.get=function(t){var e,n,r,i,o,s=this;return Ea("DocumentReference.get",arguments,0,1),$l("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.Ml().yl(this.Zr).then(function(t){return new Vl(s.firestore,s.Zr,t,!0,t instanceof Ks&&t.Ge,s.to)}):(e=this.ql,n=this.Zr,r=t,i=new Qu,o=Ol(e,n,{includeMetadataChanges:!0,Gu:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new Qr(Wr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new Qr(Wr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.o_(t)}))},Ll.prototype.withConverter=function(t){return new Ll(this.Zr,this.firestore,t)},Ll.prototype.o_=function(t){var e=t.docs.get(this.Zr);return new Vl(this.firestore,this.Zr,e,t.fromCache,t.hasPendingWrites,this.to)},Ll);function Ll(t,e,n){var r=this;return(r=Tl.call(this,e.Jr,t,n)||this).Zr=t,r.firestore=e,r.to=n,r.ql=r.firestore.Ml(),r}function Dl(t){this.e_=t,this.s_=[],this.i_=!1}function Pl(t,e){this.e_=t,this.n_=e}function Ol(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new rl({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(eu.on(e.path),o,n);return function(){o.vl(),t.Jh(s)}}var kl,Ul=(jl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},jl),Vl=(xl.prototype.data=function(t){var e=this;if(Ea("DocumentSnapshot.data",arguments,0,1),t=Kl("DocumentSnapshot.data",t),this.h_){if(this.to){var n=new Cl(this.e_,this.Zr,this.h_,this.a_,this.u_,null);return this.to.fromFirestore(n,t)}return new gl(this.e_.Jr,this.e_.t_(),t.serverTimestamps||"none",function(t){return new Rl(t,e.e_,null)}).Cl(this.h_.Ze())}},xl.prototype.get=function(t,e){var n=this;if(Ea("DocumentSnapshot.get",arguments,1,2),e=Kl("DocumentSnapshot.get",e),this.h_){var r=this.h_.data().field(Mh("DocumentSnapshot.get",t,this.Zr));if(null!==r)return new gl(this.e_.Jr,this.e_.t_(),e.serverTimestamps||"none",function(t){return new Rl(t,n.e_,n.to)}).Cl(r)}},Object.defineProperty(xl.prototype,"id",{get:function(){return this.Zr.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"ref",{get:function(){return new Rl(this.Zr,this.e_,this.to)},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"exists",{get:function(){return null!==this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"metadata",{get:function(){return new Ul(this.u_,this.a_)},enumerable:!1,configurable:!0}),xl.prototype.isEqual=function(t){if(!(t instanceof xl))throw ka("isEqual","DocumentSnapshot",1,t);return this.e_===t.e_&&this.a_===t.a_&&this.Zr.isEqual(t.Zr)&&(null===this.h_?null===t.h_:this.h_.isEqual(t.h_))&&this.to===t.to},xl),Cl=(n(Ml,kl=Vl),Ml.prototype.data=function(t){return kl.prototype.data.call(this,t)},Ml);function Ml(){return null!==kl&&kl.apply(this,arguments)||this}function xl(t,e,n,r,i,o){this.e_=t,this.Zr=e,this.h_=n,this.a_=r,this.u_=i,this.to=o}function jl(t,e){this.hasPendingWrites=t,this.fromCache=e}function ql(t){if(t.mn()&&0===t.tn.length)throw new Qr(Wr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Fl,Gl=(zl.prototype.l_=function(t,e,n){var r;if(t.L()){if("array-contains"===e||"array-contains-any"===e)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+e+"' queries on FieldPath.documentId().");if("in"===e){this.__(n,e);for(var i=[],o=0,s=n;o<s.length;o++){var u=s[o];i.push(this.f_(u))}r={arrayValue:{values:i}}}else r=this.f_(n)}else"in"!==e&&"array-contains-any"!==e||this.__(n,e),r=Oh(this.Gl,"Query.where",n,"in"===e);var a=fu.create(t,e,r);return this.d_(a),a},zl.prototype.w_=function(t,e){if(null!==this.c_.startAt)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.c_.endAt)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var n=new ku(t,e);return this.T_(n),n},zl.prototype.E_=function(t,e,n){if(!e)throw new Qr(Wr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");for(var r=[],i=0,o=this.c_.orderBy;i<o.length;i++){var s=o[i];if(s.field.L())r.push(No(this.Jr,e.key));else{var u=e.field(s.field);if(lo(u))throw new Qr(Wr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var a=s.field.$();throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}r.push(u)}}return new Nu(r,n)},zl.prototype.m_=function(t,e,n){var r=this.c_.tn;if(e.length>r.length)throw new Qr(Wr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.L()){if("string"!=typeof s)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.c_.Vn()&&-1!==s.indexOf("/"))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.c_.path.child(Zr.N(s));if(!ti.W(u))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new ti(u);i.push(No(this.Jr,a))}else{var h=Oh(this.Gl,t,s);i.push(h)}}return new Nu(i,n)},zl.prototype.f_=function(t){if("string"==typeof t){if(""===t)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.c_.Vn()&&-1!==t.indexOf("/"))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.c_.path.child(Zr.N(t));if(!ti.W(e))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return No(this.Jr,new ti(e))}if(t instanceof wh)return No(this.Jr,t.Zr);throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Da(t)+".")},zl.prototype.__=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},zl.prototype.d_=function(t){if(t instanceof fu){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.In()){var o=this.c_.hn();if(null!==o&&!o.isEqual(t.field))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.c_.an();null!==s&&this.I_(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.c_.An(n)),null===u&&r&&(u=this.c_.An(e)),null!==u)throw u===t.op?new Qr(Wr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Qr(Wr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},zl.prototype.T_=function(t){if(null===this.c_.an()){var e=this.c_.hn();null!==e&&this.I_(e,t.field)}},zl.prototype.I_=function(t,e){if(!e.isEqual(t))throw new Qr(Wr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},n(Bl,Fl=zl),Bl.prototype.where=function(t,e,n){wa("Query.where",arguments,3),Pa("Query.where",3,n);var r=Sa("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),i=Mh("Query.where",t),o=this.l_(i,r,n);return new Bl(this.c_.un(o),this.firestore,this.to)},Bl.prototype.orderBy=function(t,e){var n;if(Ea("Query.orderBy",arguments,1,2),Aa("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Qr(Wr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r=Mh("Query.orderBy",t),i=this.w_(r,n);return new Bl(this.c_.cn(i),this.firestore,this.to)},Bl.prototype.limit=function(t){return wa("Query.limit",arguments,1),Ia("Query.limit","number",1,t),Ua("Query.limit",1,t),new Bl(this.c_.ln(t),this.firestore,this.to)},Bl.prototype.limitToLast=function(t){return wa("Query.limitToLast",arguments,1),Ia("Query.limitToLast","number",1,t),Ua("Query.limitToLast",1,t),new Bl(this.c_._n(t),this.firestore,this.to)},Bl.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ba("Query.startAt",arguments,1);var r=this.A_("Query.startAt",t,e,!0);return new Bl(this.c_.fn(r),this.firestore,this.to)},Bl.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ba("Query.startAfter",arguments,1);var r=this.A_("Query.startAfter",t,e,!1);return new Bl(this.c_.fn(r),this.firestore,this.to)},Bl.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ba("Query.endBefore",arguments,1);var r=this.A_("Query.endBefore",t,e,!0);return new Bl(this.c_.dn(r),this.firestore,this.to)},Bl.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ba("Query.endAt",arguments,1);var r=this.A_("Query.endAt",t,e,!1);return new Bl(this.c_.dn(r),this.firestore,this.to)},Bl.prototype.isEqual=function(t){if(!(t instanceof Bl))throw ka("isEqual","Query",1,t);return this.firestore===t.firestore&&su(this.c_,t.c_)&&this.to===t.to},Bl.prototype.withConverter=function(t){return new Bl(this.c_,this.firestore,t)},Bl.prototype.A_=function(t,e,n,r){if(Pa(t,1,e),e instanceof Vl)return wa(t,v([e],n),1),this.E_(t,e.h_,r);var i=[e].concat(n);return this.m_(t,i,r)},Bl.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ea("Query.onSnapshot",arguments,1,4);var s={},u=0;if("object"!=typeof i[u]||vl(i[u])||(Oa("Query.onSnapshot",s=i[u],["includeMetadataChanges"]),Ta("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++),vl(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}else Ia("Query.onSnapshot","function",u,i[u]),Aa("Query.onSnapshot","function",u+1,i[u+1]),Aa("Query.onSnapshot","function",u+2,i[u+2]);var h={next:function(t){i[u]&&i[u](new Ql(r.firestore,r.c_,t,r.to))},error:i[u+1],complete:i[u+2]};return ql(this.c_),Hl(this.firestore.Ml(),this.c_,s,h)},Bl.prototype.get=function(t){var e=this;Ea("Query.get",arguments,0,1),$l("Query.get",t),ql(this.c_);var n,r,i,o,s,u=this.firestore.Ml();return(t&&"cache"===t.source?u.pl(this.c_):(n=u,r=this.c_,i=t,o=new Qu,s=Hl(n,r,{includeMetadataChanges:!0,Gu:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Qr(Wr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new Ql(e.firestore,e.c_,t,e.to)})},Bl);function Bl(t,e,n){var r=this;return(r=Fl.call(this,e.Jr,e.Gl,t)||this).c_=t,r.firestore=e,r.to=n,r}function zl(t,e,n){this.Jr=t,this.Gl=e,this.c_=n}function Hl(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new rl({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.vl(),t.Jh(s)}}var Wl,Ql=(Object.defineProperty(Jl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"empty",{get:function(){return this.P_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"size",{get:function(){return this.P_.docs.size},enumerable:!1,configurable:!0}),Jl.prototype.forEach=function(e,n){var r=this;Ea("QuerySnapshot.forEach",arguments,1,2),Ia("QuerySnapshot.forEach","function",1,e),this.P_.docs.forEach(function(t){e.call(n,r.p_(t,r.metadata.fromCache,r.P_.Mt.has(t.key)))})},Object.defineProperty(Jl.prototype,"query",{get:function(){return new Gl(this.R_,this.e_,this.to)},enumerable:!1,configurable:!0}),Jl.prototype.docChanges=function(t){t&&(Oa("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Ta("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.P_.Bt)throw new Qr(Wr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.V_&&this.y_===e||(this.V_=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.P_,e,this.p_.bind(this)),this.y_=e),this.V_},Jl.prototype.isEqual=function(t){if(!(t instanceof Jl))throw ka("isEqual","QuerySnapshot",1,t);return this.e_===t.e_&&su(this.R_,t.R_)&&this.P_.isEqual(t.P_)&&this.to===t.to},Jl.prototype.p_=function(t,e,n){return new Cl(this.e_,t.key,t,e,n,this.to)},Jl),Xl=(n(Yl,Wl=Gl),Object.defineProperty(Yl.prototype,"id",{get:function(){return this.c_.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"parent",{get:function(){var t=this.c_.path.g();return t._()?null:new Rl(new ti(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"path",{get:function(){return this.c_.path.$()},enumerable:!1,configurable:!0}),Yl.prototype.doc=function(t){Ea("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Or.t()),Ia("CollectionReference.doc","non-empty string",1,t);var e=Zr.N(t);return Rl.Zl(this.c_.path.child(e),this.firestore,this.to)},Yl.prototype.add=function(t){wa("CollectionReference.add",arguments,1),Ia("CollectionReference.add","object",1,this.to?this.to.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Yl.prototype.withConverter=function(t){return new Yl(this.g_,this.firestore,t)},Yl);function Yl(t,e,n){var r=this;if(((r=Wl.call(this,eu.on(t),e,n)||this).g_=t).length%2!=1)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.$()+" has "+t.length);return r}function Jl(t,e,n,r){this.e_=t,this.R_=e,this.P_=n,this.to=r,this.V_=null,this.y_=null,this.metadata=new Ul(n.hasPendingWrites,n.fromCache)}function Zl(t,e){if(void 0===e)return{merge:!1};if(Oa(t,e,["merge","mergeFields"]),Ta(t,"boolean","merge",e.merge),n=t,void 0!==(r=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Da(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Qr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Da(n[i]))}(n,"mergeFields",r,function(t){return"string"==typeof t||t instanceof Ba}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Qr(Wr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,r;return e}function Kl(t,e){return void 0===e?{}:(Oa(t,e,["serverTimestamps"]),_a(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function $l(t,e){Aa(t,"object",1,e),e&&(Oa(t,e,["source"]),_a(t,0,"source",e.source,["default","server","cache"]))}function tf(t,e,n){if(e instanceof wh){if(e.firestore!==n)throw new Qr(Wr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ka(t,"DocumentReference",1,e)}function ef(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var nf,rf={Firestore:bl,GeoPoint:hh,Timestamp:Xr,Blob:Fa,Transaction:_l,WriteBatch:Sl,DocumentReference:Rl,DocumentSnapshot:Vl,Query:Gl,QueryDocumentSnapshot:Cl,QuerySnapshot:Ql,CollectionReference:Xl,FieldPath:Ba,FieldValue:uh,setLogLevel:bl.setLogLevel,CACHE_SIZE_UNLIMITED:ml};(nf=of).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new bl(e,n,new el);var e,n},"PUBLIC").setServiceProps(Object.assign({},rf))),nf.registerVersion("@firebase/firestore","1.16.1")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
